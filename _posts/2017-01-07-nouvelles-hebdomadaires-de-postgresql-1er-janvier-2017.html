---
layout: post
title: Nouvelles hebdomadaires de PostgreSQL - 1er janvier 2017
---

<h2>Les nouveaut&eacute;s des produits d&eacute;riv&eacute;s</h2>
<ul>
<li>pgpool-II versions 3.6.1, 3.5.5, 3.4.9, 3.3.13, 3.2.18 et 3.1.21 publi&eacute;es. Pgpool-II 3.1.21 est la derni&egrave;re version de la s&eacute;rie 3.1.x&nbsp;: <a target="_blank" href="http://www.pgpool.net/docs/latest/en/html/release.html">http://www.pgpool.net/docs/latest/en/html/release.html</a></li>
<li>PL/Proxy 2.7, un syst&egrave;me de partitionnement de base de donn&eacute;es impl&eacute;ment&eacute; comme un langage proc&eacute;dural&nbsp;: <a target="_blank" href="https://plproxy.github.io">https://plproxy.github.io</a></li>
</ul>
<h2>PostgreSQL Local</h2>
<ul>
<li>La <em>PGConf India 2017</em> aura lieu les 2 &amp; 3 mars 2017 &agrave; Bengalore (&Eacute;tat du Karnataka en Inde)&nbsp;: <a target="_blank" href="http://pgconf.in/">http://pgconf.in/</a></li>
<li>PostgreSQL@SCaLE aura lieu les 2 &amp; 3 mars 2017 au centre des conventions de Pasadena, comme partie du SCaLE 15X&nbsp;: <a target="_blank" href="http://www.socallinuxexpo.org/scale/15x/">http://www.socallinuxexpo.org/scale/15x/</a></li>
<li>PgConf.Russia 2017 se d&eacute;roulera du 15 au 17 mars 2017 &agrave; Moscou&nbsp;: <a target="_blank" href="https://pgconf.ru/en">https://pgconf.ru/en</a></li>
<li>Le PGDay Asia 2017 s'&eacute;tendra du 17 au 18 mars &agrave; Singapour. L'appel &agrave; conf&eacute;renciers s'&eacute;teindra le 16 janvier 2017&nbsp;: <a target="_blank" href="http://tinyurl.com/pgDay-Asia-2017-Cfp">http://tinyurl.com/pgDay-Asia-2017-Cfp</a></li>
<li>Le PGDay nordique se tiendra &agrave; Stockholm (Su&egrave;de) au Sheraton Hotel, le 21 mars 2017. L'appel &agrave; conf&eacute;renciers expire le 9 janvier 2017&nbsp;: <a target="_blank" href="https://2017.nordicpgday.org/cfp/">https://2017.nordicpgday.org/cfp/</a></li>
<li>Le pgDay Paris 2017 aura lieu &agrave; Paris (France) le 23 mars 2017. L'appel &agrave; conf&eacute;renciers court jusqu'au 9 janvier&nbsp;: <a target="_blank" href="http://2017.pgday.paris/callforpapers/">http://2017.pgday.paris/callforpapers/</a></li>
<li>PGCon 2017 aura lieu &agrave; Ottawa du 23 au 26 mai. Les propositions seront attendues jusqu'au 19 janvier 2017&nbsp;: <a target="_blank" href="http://www.pgcon.org/2017/papers.php">http://www.pgcon.org/2017/papers.php</a></li>
</ul>
<h2>PostgreSQL dans les m&eacute;dia</h2>
<ul>
<li>Planet PostgreSQL : <a target="_blank" href="http://planet.postgresql.org/">http://planet.postgresql.org/</a></li>
<li>Planet PostgreSQLFr : <a target="_blank" href="http://planete.postgresql.fr/">http://planete.postgresql.fr/</a></li>
</ul>
<p>PostgreSQL Weekly News / les nouvelles hebdomadaires vous sont offertes cette semaine par David Fetter. Traduction par l'&eacute;quipe PostgreSQLFr sous licence CC BY-NC-SA. La version originale se trouve &agrave; l'adresse suivante : <a target="_blank" href="http://www.postgresql.org/message-id/20170101214521.GA22193@fetter.org">http://www.postgresql.org/message-id/20170101214521.GA22193@fetter.org</a></p>
<p>Proposez vos articles ou annonces avant dimanche 15:00 (heure du Pacifique). Merci de les envoyer en anglais &agrave; david (a) fetter.org, en allemand &agrave; pwn (a) pgug.de, en italien &agrave; pwn (a) itpug.org et en espagnol &agrave; pwn (a) arpug.com.ar.</p>    <h2>Correctifs appliqu&eacute;s</h2>
<p>Tom Lane pushed:</p>
<ul>
<li>Remove triggerable Assert in hashname(). hashname() asserted that the key string it is given is shorter than NAMEDATALEN. That should surely always be true if the input is in fact a regular value of type "name". However, for reasons of coding convenience, we allow plain old C strings to be treated as "name" values in many places. Some SQL functions accept arbitrary "text" inputs, convert them to C strings, and pass them otherwise-untransformed to syscache lookups for name columns, allowing an overlength input value to trigger hashname's Assert. This would be a DOS problem, except that it only happens in assert-enabled builds which aren't recommended for production. In a production build, you'll just get a name lookup error, since regardless of the hash value computed by hashname, the later equality comparison checks can't match. Likewise, if the catalog lookup is done by seqscan or indexscan searches, there will just be a lookup error, since the name comparison functions don't contain any similar length checks, and will see an overlength input as unequal to any stored entry. After discussion we concluded that we should simply remove this Assert. It's inessential to hashname's own functionality, and having such an assertion in only some paths for name lookup is more of a foot-gun than a useful check. There may or may not be a case for the affected callers to do something other than let the name lookup fail, but we'll consider that separately; in any case we probably don't want to change such behavior in the back branches. Per report from Tushar Ahuja. Back-patch to all supported branches. Report: <a target="_blank" href="https://postgr.es/m/7d0809ee-6f25-c9d6-8e74-5b2967830d49@enterprisedb.com">https://postgr.es/m/7d0809ee-6f25-c9d6-8e74-5b2967830d49@enterprisedb.com</a> Discussion: <a target="_blank" href="https://postgr.es/m/17691.1482523168@sss.pgh.pa.us">https://postgr.es/m/17691.1482523168@sss.pgh.pa.us</a> <a target="_blank" href="http://git.postgresql.org/pg/commitdiff/54386f3578258caa5a1de97c434eee2c9ee2ab06">http://git.postgresql.org/pg/commitdiff/54386f3578258caa5a1de97c434eee2c9ee2ab06</a></li>
<li>Fix interval_transform so it doesn't throw away non-no-op casts. interval_transform() contained two separate bugs that caused it to sometimes mistakenly decide that a cast from interval to restricted interval is a no-op and throw it away. First, it was wrong to rely on dt.h's field type macros to have an ordering consistent with the field's significance; in one case they do not. This led to mistakenly treating YEAR as less significant than MONTH, so that a cast from INTERVAL MONTH to INTERVAL YEAR was incorrectly discarded. Second, fls(1&lt;&lt;k) produces k+1 not k, so comparing its output directly to SECOND was wrong. This led to supposing that a cast to INTERVAL MINUTE was really a cast to INTERVAL SECOND and so could be discarded. To fix, get rid of the use of fls(), and make a function based on intervaltypmodout to produce a field ID code adapted to the need here. Per bug #14479 from Piotr Stefaniak. Back-patch to 9.2 where transform functions were introduced, because this code was born broken. Discussion: <a target="_blank" href="https://postgr.es/m/20161227172307.10135.7747@wrigleys.postgresql.org">https://postgr.es/m/20161227172307.10135.7747@wrigleys.postgresql.org</a> <a target="_blank" href="http://git.postgresql.org/pg/commitdiff/f0774abde868e0b5a2acbe75b5028884752f739d">http://git.postgresql.org/pg/commitdiff/f0774abde868e0b5a2acbe75b5028884752f739d</a></li>
<li>Remove manual breaks in NodeTag assignments to fix duplicate tag numbers. Commit f0e44751d added new node tags at a place in the tag numbering where there was no daylight left before the next hard-coded number, resulting in some duplicate tag assignments. This doesn't seem to have caused any big problem so far, but it's surely trouble waiting to happen. We could adjust the manually assigned breakpoints to make more room, but that just leaves the same hazard waiting to strike again in future. What seems like a better idea is to get rid of the manual assignments and leave NodeTags to be automatically assigned, consecutively from one on up. This means that any change in the tag list forces a backend-wide recompile, but realistically that's usually needed anyway. Discussion: <a target="_blank" href="https://postgr.es/m/29670.1482942811@sss.pgh.pa.us">https://postgr.es/m/29670.1482942811@sss.pgh.pa.us</a> <a target="_blank" href="http://git.postgresql.org/pg/commitdiff/80a7298b9eb7f108ef20be6ee00d9513a43c61a0">http://git.postgresql.org/pg/commitdiff/80a7298b9eb7f108ef20be6ee00d9513a43c61a0</a></li>
<li>Fix unstable regression test results. Commit 2ac3ef7a0 added a query with an underdetermined output row order; it has failed multiple times in the buildfarm since then. Add an ORDER BY to fix. Also, don't rely on a DROP CASCADE to drop in a well-determined order; that hasn't failed yet but I don't trust it much, and we're not saving any typing by using CASCADE anyway. <a target="_blank" href="http://git.postgresql.org/pg/commitdiff/257d8157205a7be5f9799e8941b922521d678a25">http://git.postgresql.org/pg/commitdiff/257d8157205a7be5f9799e8941b922521d678a25</a></li>
<li>Avoid assuming that instr_time == struct timeval in pgbench logging. This code was presuming undue familiarity with the contents of the instr_time struct. That was already broken on Windows, and it's about to get broken on most other platforms as well. The simplest solution that preserves the current output definition is to just do our own gettimeofday() call here. Realistically, the extra cost is probably negligible in comparison to everything else that's going on in a pgbench transaction, so it's not worth sweating over. On Windows, the precision delivered by gettimeofday() is lower than one could wish, but this is still a big improvement over printing zeroes, as the code did before. Discussion: <a target="_blank" href="https://postgr.es/m/8837.1483216839@sss.pgh.pa.us">https://postgr.es/m/8837.1483216839@sss.pgh.pa.us</a> <a target="_blank" href="http://git.postgresql.org/pg/commitdiff/74baa1e3b89c1651ade1afeffc715cac24041e2f">http://git.postgresql.org/pg/commitdiff/74baa1e3b89c1651ade1afeffc715cac24041e2f</a></li>
</ul>
<p>Magnus Hagander pushed:</p>
<ul>
<li>Fix typo comments. Erik Rijkers <a target="_blank" href="http://git.postgresql.org/pg/commitdiff/6cfa54e384700d4a2124e5c4d7a1eb91e8e0eeb7">http://git.postgresql.org/pg/commitdiff/6cfa54e384700d4a2124e5c4d7a1eb91e8e0eeb7</a></li>
<li>Don't rename .partial files in pg_receivexlog if an error occured. In 56c7d8d the behavior to keep .partial segments around (considered corrupt) in case an connection failure occurs was accidentally removed. This would lead to an incomplete segment being considered complete. Author: Michael Paquier <a target="_blank" href="http://git.postgresql.org/pg/commitdiff/3ea56fffd66fe2c5857f36359ae16d4cabcdeef6">http://git.postgresql.org/pg/commitdiff/3ea56fffd66fe2c5857f36359ae16d4cabcdeef6</a></li>
</ul>
<p>Andrew Dunstan pushed:</p>
<ul>
<li>Explain unaccounted for space in pgstattuple. In addition to space accounted for by tuple_len, dead_tuple_len and free_space, the table_len includes page overhead, the item pointers table and padding bytes. Backpatch to live branches. <a target="_blank" href="http://git.postgresql.org/pg/commitdiff/71f996d22125eb6cfdbee6094f44370aa8dec610">http://git.postgresql.org/pg/commitdiff/71f996d22125eb6cfdbee6094f44370aa8dec610</a></li>
</ul>
<p>Peter Eisentraut pushed:</p>
<ul>
<li>Make more use of RoleSpec struct. Most code was casting this through a generic Node. By declaring everything as RoleSpec appropriately, we can remove a bunch of casts and ad-hoc node type checking. Reviewed-by: Alvaro Herrera &lt;alvherre@2ndquadrant.com&gt; <a target="_blank" href="http://git.postgresql.org/pg/commitdiff/2e254130d1d3f16575f2d72952ab23b4e27d035a">http://git.postgresql.org/pg/commitdiff/2e254130d1d3f16575f2d72952ab23b4e27d035a</a></li>
<li>Expand ad-hoc unit abbreviations in function descriptions. There is no need to use abbreviations here, so just write it out for consistency. <a target="_blank" href="http://git.postgresql.org/pg/commitdiff/27866bd1e88c7b564b42394a0d5b069b015666c4">http://git.postgresql.org/pg/commitdiff/27866bd1e88c7b564b42394a0d5b069b015666c4</a></li>
<li>Fix typo in comment <a target="_blank" href="http://git.postgresql.org/pg/commitdiff/db779d941e0a05ea4647455d0b386b38ef58983b">http://git.postgresql.org/pg/commitdiff/db779d941e0a05ea4647455d0b386b38ef58983b</a></li>
</ul>
<h2>Correctifs en attente</h2>
<p>Pavan Deolasee sent in another revision of a patch to fix some issues in WARM.</p>
<p>Kyotaro HORIGUCHI sent in another revision of a patch to clean up negative cache of pg_statistic when dropping a relation and clean up negative cache of pg_class when dropping a schema.</p>
<p>Kyotaro HORIGUCHI sent in another revision of a patch to redesign psql's tab completion and use that infrastructure to implement IF (NOT) EXISTS completion.</p>
<p>Ashutosh Bapat sent in another revision of a patch to imlement partition-wise join for join between (declaratively) partitioned tables.</p>
<p>Amit Kapila sent in another revision of a patch to implement WAL for hash indexes.</p>
<p>Dmitry Dolgov sent in another revision of a patch to implement generic type subscripting.</p>
<p>Amit Langote sent in five more revisions of a patch to implement declarative partitioning.</p>
<p>Amit Langote sent in a patch to fix an infelicity between OID columns and table inheritance.</p>
<p>Mithun Cy sent in two more revisions of a patch to cache hash index meta pages.</p>
<p>Etsuro Fujita sent in another revision of a patch to push more FULL joins to the PostgreSQL FDW.</p>
<p>Amit Kapila sent in another revision of a patch to implement parallel index scans.</p>
<p>Nikita Glukhov sent in another revision of a patch to implement recursive json_populate_record().</p>
<p>Peter Eisentraut sent in another revision of a patch to add ICU support.</p>
<p>Rafia Sabih sent in another revision of a patch to implement parallel index-only scans.</p>
<p>Amit Kapila sent in a patch to parallelize queries containing subplans.</p>
<p>Thomas Munro sent in a patch to fix dsa tranche registration.</p>
<p>Micha&Atilde;&laquo;l Paquier sent in two more revisions of a patch to enable pg_receivelog to enable adjusting compression for tar format.</p>
<p>Peter Eisentraut sent in a patch to add some information about the systemd RemoveIPC issue to the documentation.</p>
<p>Ideriha Takeshi sent in a patch to add a DECLARE STATEMENT command in ECPG.</p>
<p>Craig Ringer sent in another revision of a patch to introduce txid_status(bigint) to get status of an xact.</p>
<p>Thomas Munro sent in another revision of a patch to allow measuring replay lag.</p>
<p>Claudio Freire sent in another revision of a patch to enable VACUUM to use more than 1GB of work mem.</p>
<p>Craig Ringer sent in two revisions of a patch to fix a minor race between commit_ts slru truncation and lookups.</p>
<p>Tom Lane sent in another revision of a patch to improve RLS planning.</p>
<p>&Atilde;lvaro Herrera sent in two revisions of a patch to rewrite HeapSatisfiesHOTAndKey.</p>
<p>&Atilde;lvaro Herrera sent in two more revisions of a patch to implement indirect indexes.</p>
<p>Vik Fearing sent in a patch to change the encoding of the French translation encoding from ISO-8859-1 to UTF-8.</p>
<p>Jim Nasby sent in another revision of a patch to increase pltcl test coverage.</p>
<p>Peter Eisentraut sent in another revision of a patch to add background sessions.</p>
<p>Tom Lane sent in a patch to eliminate gettimeofday() on platforms where better options are available.</p>
<p>Haribabu Kommi sent in a patch to implement a columnar storage extension.</p>
<p>Fabien COELHO sent in another revision of a patch to fix some pg_stat_statements query normalization issues with combined queries.</p>
<p>Yury Zhuravlev sent in another revision of a patch to implement a CMake-based build system.</p>
<p>Petr Jel&Atilde;&shy;nek sent in another revision of a patch to implement logical replication.</p>
<p>Micha&Atilde;&laquo;l Paquier sent in another revision of a patch to fix a potential data loss of 2PC files.</p>
<p>Fabr&Atilde;&shy;zio de Royes Mello sent in another revision of a patch to implement COMMENT ON CURRENT DATABASE.</p>
<p>Amit Kapila sent in another revision of a patch to speed up clog Access by increasing CLOG buffers.</p>
<p>Amit Kapila sent in a patch to fix an issue where group clear xid can leak semaphore count.</p>
<p>Peter Eisentraut sent in a patch to generate fmgr prototypes automatically.</p>
<p>Peter Eisentraut sent in another revision of a patch to implement sequence data types.</p>
<p>Peter Eisentraut sent in a patch to put "use strict" in all Perl programs.</p>
<p>Peter Eisentraut sent in a patch to create the INSTALL file via XSLT and Pandoc. This is one more step on the way to replacing the old tool chain of jade and lynx.</p>
<p>Peter Eisentraut sent in a patch to automatically casts the result of copyNode() back to the input type, if the compiler supports something like typeof().</p>
<p>Stas Kelvich sent in another revision of a patch to implement logical decoding of two-phase transactions.</p>
<p>Magnus Hagander sent in another revision of a patch to support huge pages on Windows.</p>
<p>Peter Eisentraut sent in another revision of a patch to add identity columns per the SQL standard.</p>
<p>Magnus Hagander sent in a patch to change the backup and replication defaults to something more useful.</p>
<p>Peter Eisentraut sent in another revision of a patch to allow DROP FUNCTION to drop multiple functions in one command.</p>
<p>Peter Eisentraut sent in a patch to implement safer node casting.</p>
<p>Magnus Hagander sent in another revision of a patch to make streaming the pg_basebackup default.</p>
<p>David Fetter sent in another revision of a patch to add a hook which allows disabling simple UPDATEs and DELETEs without a WHERE clause.</p>
<p>Thomas Munro sent in a patch to add an isolation test for SERIALIZABLE READ ONLY DEFERRABLE.</p>
<p>Pavel St&Auml;&rsaquo;hule sent in a patch to add some runtime checks to PL/pgsql.</p>
<p>Simon Riggs sent in another revision of a patch to make some changes to the recovery.conf API.</p>
