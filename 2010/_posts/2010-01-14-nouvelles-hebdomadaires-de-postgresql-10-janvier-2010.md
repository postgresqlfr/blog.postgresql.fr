---
layout: post
title: "Nouvelles hebdomadaires de PostgreSQL - 10 janvier 2010"
author: "NBougain"
redirect_from: "index.php?post/2010-01-14-nouvelles-hebdomadaires-de-postgresql-10-janvier-2010 "
---


<p>F&eacute;licitations &agrave; Alvaro Herrera, papa d'une petite fille.</p>

<p>Le "Hot Standby User's Group" se r&eacute;unira virtuellement le 13 janvier &agrave; 16h00 UTC, plut&ocirc;t que le 6 comme indiqu&eacute; &agrave; l'origine. Plus de d&eacute;tails sur&nbsp;: 

<a target="_blank" href="http://www.postgresql.org/about/event.1013">http://www.postgresql.org/about/event.1013</a></p>

<p><strong>Les nouveaut&eacute;s des produits d&eacute;riv&eacute;s</strong></p>

<ul>

<li>Des paquets de Bucardo, un syst&egrave;me de r&eacute;plication asynchrone capable de g&eacute;rer deux instances ma&icirc;tresses, sont disponibles pour Fedora, et sur CentOS et RHEL en utilisant EPEL. 

<a target="_blank" href="https://fedoraproject.org/wiki/EPEL/FAQ#howtouse">https://fedoraproject.org/wiki/EPEL/FAQ#howtouse</a></li>

<li>pgfincore, un ensemble de fonctions de gestion bas-niveau des relations utilisant mincore pour explorer la m&eacute;moire cache&nbsp;: 

<a target="_blank" href="http://pgfoundry.org/projects/pgfincore/">http://pgfoundry.org/projects/pgfincore/</a></li>

</ul>

<p><strong>La fonctionnalit&eacute; 8.5 de la semaine</strong></p>

<p>Vous pouvez maintenant logger vos requ&ecirc;tes, erreurs, etc. en utilisant %e dans l'instruction log_line_prefix.</p>

<p><strong>Offres d'emplois autour de PostgreSQL en janvier</strong></p>

<ul>

<li><a target="_blank" href="http://archives.postgresql.org/pgsql-jobs/2010-01/threads.php">http://archives.postgresql.org/pgsql-jobs/2010-01/threads.php</a></li>

</ul>

<p><strong>PostgreSQL Local</strong></p>

<ul>

<li>La premi&egrave;re r&eacute;union du "New York Capital District PUG" aura lieu le 7 janvier 2010&nbsp;: 

<a target="_blank" href="http://nycdpug.x10hosting.com/">http://nycdpug.x10hosting.com/</a></li>

<li>Stefan Keller, de l'universit&eacute; des sciences appliqu&eacute;es de Rapperswil (HSR), animera un s&eacute;minaire intitul&eacute; "Introduction &agrave; PostGIS/PostgreSQL" le 14 janvier 2010 &agrave; Zurich (Suisse)&nbsp;: 

<a target="_blank" href="http://www.gis.hsr.ch/wiki/Agenda">http://www.gis.hsr.ch/wiki/Agenda</a></li>

<li>&Agrave; la recherche de volontaires pour la rencontre de la "Open Day Linux Conf AU" &agrave; Wellington, Nouvelle Z&eacute;lande, le 23 janvier 2010 entre 11 et 14h. Contactez selena -at- postgresql.org.</li>

<li>L'appel &agrave; conf&eacute;rencier pour "East" est lanc&eacute; avec, comme date limite, le 30 janvier 2010. D&eacute;tails sur&nbsp;: 

<a target="_blank" href="http://www.postgresqlconference.org/">http://www.postgresqlconference.org/</a></li>

<li>Le PGDay-Cuba 2010 sera tenu du 4 au 6 f&eacute;vrier 2010 &agrave; l'Universit&eacute; des Sciences Informatiques, &agrave; La Havane. Sont invit&eacute;s les participants de Cuba, de la R&eacute;publique Dominicaine et du Venezuela.</li>

<li>Le FOSDEM 2010 aura lieu &agrave; Bruxelles les 6 &amp; 7 f&eacute;vrier 2010&nbsp;: 

<a target="_blank" href="http://www.fosdem.org/">http://www.fosdem.org/</a></li>

<li>Le PUG allemand aura un stand dans "l'Open Source Park" au Cebit 2010 du 2 au 6 mars 2010 &agrave; Hanovre&nbsp;: 

<a target="_blank" href="http://www.cebit.de/">http://www.cebit.de/</a></li>

<li>Le "Chemnitzer Linuxtage" aura lieu &agrave; Chemnitz (All.) les 13 &amp; 14 mars 2010&nbsp;: 

<a target="_blank" href="http://chemnitzer.linux-tage.de/">http://chemnitzer.linux-tage.de/</a></li>

<li>La PgCon 2010 aura lieu les 20 &amp; 21 mai 2010 &agrave; Ottawa avec des tutoriels les 18 et 19. L'appel &agrave; conf&eacute;renciers est lanc&eacute;&nbsp;! 

<a target="_blank" href="http://www.pgcon.org/2010/papers.php">http://www.pgcon.org/2010/papers.php</a></li>

<li>L'appel aux propositions est lanc&eacute; pour l'OSCON, qui aura lieu &agrave; Portland (Oregon) du 19 au 23 juillet 2010&nbsp;: 

<a target="_blank" href="http://post.oreilly.com/f2f/9z1zqmm5lhkab0uogt3avlvc4u59bro6f917re423d8">http://post.oreilly.com/f2f/9z1zqmm5lhkab0uogt3avlvc4u59bro6f917re423d8</a></li>

</ul>

<p><strong>PostgreSQL dans les m&eacute;dia</strong></p>

<ul>

<li>Planet PostgreSQL&nbsp;: 

<a target="_blank" href="http://planet.postgresql.org/">http://planet.postgresql.org/</a></li>

<li>Planet PostgreSQLFr&nbsp;: 

<a target="_blank" href="http://planete.postgresql.fr/">http://planete.postgresql.fr/</a></li>

</ul>

<p><i>PostgreSQL Weekly News / les nouvelles hebdomadaires vous sont offertes cette semaine par David Fetter. Traduction par l'&eacute;quipe PostgreSQLFr sous licence CC BY-NC-SA.</i></p>

<p><i>Proposez vos articles ou annonces avant dimanche 15:00 (heure du Pacifique). Merci de les envoyer en anglais &agrave; david (a) fetter.org, en allemand &agrave; pwn (a) pgug.de, en italien &agrave; pwn (a) itpug.org.</i></p>

<p>(<a target="_blank" href="http://www.postgresql.org/community/weeklynews/pwn20100110">lien vers l'article original</a>)</p>

<!--more-->


<p><strong>Correctifs appliqu&eacute;s</strong></p>

<p>Tom Lane a commit&eacute;&nbsp;:</p>

<ul>

<li>When estimating the selectivity of an inequality "column &gt; constant" or "column &lt; constant", and the comparison value is in the first or last histogram bin or outside the histogram entirely, try to fetch the actual column min or max value using an index scan (if there is an index on the column). If successful, replace the lower or upper histogram bound with that value before carrying on with the estimate. This limits the estimation error caused by moving min/max values when the comparison value is close to the min or max. Per a complaint from Josh Berkus. It is tempting to consider using this mechanism for mergejoinscansel as well, but that would inject index fetches into main-line join estimation not just endpoint cases. I'm refraining from that until we can get a better handle on the costs of doing this type of lookup.</li>

<li>Improve PGXS makefile system to allow the module's makefile to specify where to install DATA and DOCS files. This is mainly intended to allow versioned installation, eg, install into contrib/fooM.N/ rather than directly into contrib/. Mark Cave-Ayland.</li>

<li>Get rid of the need for manual maintenance of the initial contents of pg_attribute, by having genbki.pl derive the information from the various catalog header files. This greatly simplifies modification of the "bootstrapped" catalogs. This patch finally kills genbki.sh and Gen_fmgrtab.sh; we now rely entirely on Perl scripts for those build steps. To avoid creating a Perl build dependency where there was not one before, the output files generated by these scripts are now treated as distprep targets, ie, they will be built and shipped in tarballs. But you will need a reasonably modern Perl (probably at least 5.6) if you want to build from a CVS pull. The changes to the MSVC build process are untested, and may well break --- we'll soon find out from the buildfarm. John Naylor, based on ideas from Robert Haas and others.</li>

<li>In pgsql/src/backend/Makefile, fix parallel-make timing problem.</li>

<li>Remove too-smart-for-its-own-good optimization of not overwriting the output files when they haven't changed. This confuses make because the build fails to update the file timestamps, and so it keeps on doing the action over again.</li>

<li>Fix a few places where we needed -I. in CPPFLAGS to work properly in VPATH builds. We had this already in several places, but not all.</li>

<li>In pgsql/src/backend/catalog/genbki.pl, further code review for genbki.pl. Improve comments, fix some rather random code choices, don't slavishly duplicate the original pg_attribute.h's failure to put an OID into Schema_pg_index entries.</li>

<li>Fix genbki.pl and Gen_fmgrtab.pl to use PID-specific temp file names, so that it's safe if a parallel make chooses to run two concurrent copies. Also, work around a memory leak in some versions of Perl.</li>

<li>Add support for doing FULL JOIN ON FALSE. While this is really a rather peculiar variant of UNION ALL, and so wouldn't likely get written directly as-is, it's possible for it to arise as a result of simplification of less-obviously-silly queries. In particular, now that we can do flattening of subqueries that have constant outputs and are underneath an outer join, it's possible for the case to result from simplification of queries of the type exhibited in bug #5263. Back-patch to 8.4 to avoid a functionality regression for this type of query.</li>

<li>In pgsql/contrib/auto_explain/auto_explain.c, add missing 'static' keywords.</li>

<li>Fix missing &lt;manvolnum&gt; markers in dblink reference entries. Silences complaints from "make man", and allows these man pages to be included in man3/.</li>

<li>Make the makefile pass $MAJORVERSION to genbki.pl, not $VERSION which is overridden in the snapshot build script. $MAJORVERSION is what it really wanted anyway, so we can tighten up the parsing of --set-version's argument.</li>

<li>In pgsql/src/backend/catalog/genbki.pl, make error messages for bad --set-version argument more useful. Per Stefan Kaltenbrunner.</li>

<li>In pgsql/src/backend/utils/cache/spccache.c, access hash entry before freeing it, not after.</li>

<li>In pgsql/src/backend/utils/cache/spccache.c, fix spccache.c to not suppose that a cache entry will live across database access, per testing with CLOBBER_CACHE_ALWAYS. Minor other editorialization.</li>

<li>Alter the configure script to fail immediately if the C compiler does not provide a working 64-bit integer datatype. As recently noted, we've been broken on such platforms since early in the 8.4 development cycle. Since it took nearly two years for anyone to even notice, it seems that the rationale for continuing to support such platforms has reached the point of non-existence. Rather than thrashing around to try to make it work again, we'll just admit up front that this no longer works. Back-patch to 8.4 since that branch is also broken. We should go around to remove INT64_IS_BUSTED support, but just in HEAD, so that seems like material for a separate commit.</li>

<li>Make configure check the version of Perl we're building with, and reject versions &lt; 5.8. Also, if there's no Perl, emit a warning informing the user that he won't be able to build from a CVS pull. This is exactly the same treatment we give Bison and Perl, and for the same reasons.</li>

<li>Fail in a nicer way if we have --with-perl and no Perl.</li>

<li>Remove all the special-case code for INT64_IS_BUSTED, per decision that we're not going to support that anymore. I did keep the 64-bit-CRC-with-32-bit-arithmetic code, since it has a performance excuse to live. It's a bit moot since that's all ifdef'd out, of course.</li>

<li>Fix (some of the) breakage introduced into query-cancel processing by Hot Standby. It is absolutely not okay to throw an ereport(ERROR) in any random place in the code just because DoingCommandRead is set; interrupting, say, OpenSSL in the midst of its activities is guaranteed to result in heartache. Instead of that, undo the original optimizations that threw away QueryCancelPending anytime we were starting or finishing a command read, and instead discard the cancel request within ProcessInterrupts if we find that there is no Hot Standby reason for forcing a cancel and we are DoingCommandRead. In passing, may I once again condemn the practice of changing the code and not fixing the adjacent comment that you just turned into a lie?</li>

<li>In pgsql/src/backend/utils/adt/varbit.c, make bit/varbit substring() treat any negative length as meaning "all the rest of the string". The previous coding treated only -1 that way, and would produce an invalid result value for other negative values. We ought to fix it so that 2-parameter bit substring() is a different C function and the 3-parameter form throws error for negative length, but that takes a pg_proc change which is impractical in the back branches; and in any case somebody might be relying on -1 working this way. So just do this as a back-patchable fix.</li>

<li>Fix 3-parameter form of bit substring() to throw error for negative length, as required by SQL standard.</li>

<li>In pgsql/src/backend/executor/execMain.c, fix oversight in EvalPlanQualFetch: after failing to lock a tuple because someone else has just updated it, we have to set priorXmax to that tuple's xmax (ie, the XID of the other xact that updated it) before looping back to examine the next tuple. Obviously, the next tuple in the update chain should have that XID as its xmin, not the same xmin as the preceding tuple that we had been trying to lock. The mismatch would cause the EvalPlanQual logic to decide that the tuple chain ended in a deletion, when actually there was a live tuple that should have been found. I inserted this error when recently adding logic to EvalPlanQual to make it lock tuples before returning them (as opposed to the old method in which the lock would occur much later, causing a great deal of work to be wasted if we only then discover someone else updated it). Sigh. Per today's report from Takahiro Itagaki of inconsistent results during pgbench runs.</li>

<li>In pgsql/src/pl/plperl/GNUmakefile, fix makefile so it works for VPATH case.</li>

<li>In pgsql/src/backend/executor/execQual.c, make ExecEvalFieldSelect throw a more intelligible error if it's asked to extract a system column, and remove a couple of lines that are useless in light of the fact that we aren't ever going to support this case. There isn't much point in trying to make this work because a tuple Datum does not carry many of the system columns. Per experimentation with a case reported by Dean Rasheed; we'll have to fix his problem somewhere else.</li>

<li>Improve plpgsql's handling of record field references by forcing all potential field references in SQL expressions to have RECFIELD datum-array entries at parse time. If it turns out that the reference is actually to a SQL column, the RECFIELD entry is useless, but it costs little. This allows us to get rid of the previous use of FieldSelect applied to a whole-row Param for the record variable; which was not only slower than a direct RECFIELD reference, but failed for references to system columns of a trigger's NEW or OLD record. Per report and fix suggestion from Dean Rasheed.</li>

<li>In pgsql/src/pl/plpgsql/src/gram.y, improve plpgsql parsing to report "foo is not a known variable", rather than a generic syntax error, when seeing "foo := something" and foo isn't recognized. This buys back most of the helpfulness discarded in my previous patch by not throwing errors when a qualified name appears to match a row variable but the last component doesn't match any field of the row. It covers other cases where our error messages left something to be desired, too.</li>

<li>In pgsql/src/pl/plperl/GNUmakefile, remove unnecessary use of temp file. Tim Bunce.</li>

<li>In pgsql/src/include/utils/rel.h, some trivial adjustments in comments for struct RelationData.</li>

</ul>

<p>Heikki Linnakangas a commit&eacute;&nbsp;:</p>

<ul>

<li>Write an end-of-backup WAL record at pg_stop_backup(), and wait for it at recovery instead of reading the backup history file. This is more robust, as it stops you from prematurely starting up an inconsisten cluster if the backup history file is lost for some reason, or if the base backup was never finished with pg_stop_backup(). This also paves the way for a simpler streaming replication patch, which doesn't need to care about backup history files anymore. The backup history file is still created and archived as before, but it's not used by the system anymore. It's just for informational purposes now. Bump PG_CONTROL_VERSION as the location of the backup startpoint is now written to a new field in pg_control, and catversion because initdb is required Original patch by Fujii Masao per Simon's idea, with further fixes by Heikki Linnakangas.</li>

</ul>

<p>Magnus Hagander a commit&eacute;&nbsp;:</p>

<ul>

<li>In pgsql/src/include/storage/s_lock.h, add a Win64-specific spin_delay() function. We can't use the same as before, since MSVC on Win64 doesn't support inline assembly.</li>

<li>In pgsql/src/include/storage/s_lock.h, use _mm_pause() for win64 spin_delay(), per note from Tsutomu Yamada.</li>

<li>In pgsql/src/tools/msvc/Project.pm, disable linker warning 4197 on Win64, that is caused by the fact that we export symbols both using __declspec(dllexport) (via the PGDLLIMPORT macro) and using full-dll-export. This works without warning on Win32, but not on Win64. In passing, fix the fact that the framework could never deal with more than one disbled linker warning - because MSVC wants commas between linker warnings, and semicolons between compiler warnings...</li>

<li>Move the default configuration for the MSVC build system to config_default.pl, and allow using config.pl to override the defaults. config.pl is removed from the repository, so changes there will no longer show up when doing diff, and will not prevent switching branches and such things. config.pl would normally be used to override single values, but if an old-style config.pl is read, it will override the entire default configuration, making it backwards compatible.</li>

<li>Create typedef pgsocket for storing socket descriptors. This silences some warnings on Win64. Not using the proper SOCKET datatype was actually wrong on Win32 as well, but didn't cause any warnings there. Also create define PGINVALID_SOCKET to indicate an invalid/non-existing socket, instead of using a hardcoded -1 value.</li>

<li>In pgsql/doc/src/sgml/installation.sgml, update Windows installation notes. pginstaller isn't used anymore, in favor of the one-click installers. Make it clear that we support Windows 2000 and newer with the native port, instead of first saying we support NT4 and then saying we don't.</li>

</ul>

<p>Andrew Dunstan a commit&eacute;&nbsp;:</p>

<ul>

<li>In pgsql/src/pl/plperl/plperl.c, check values passed back from PLPerl to the database, via function return, trigger tuple modification or SPI call, to ensure they are valid in the server encoding. Along the way, replace uses of SvPV(foo, PL_na) with SvPV_nolen(foo) as recommended in the perl docs. Bug report from Hannu Krosing.</li>

<li>In pgsql/src/backend/utils/mb/wchar.c, remove sometimes inaccurate error hint about source of wrongly encoded data.</li>

<li>Tidy up and refactor plperl.c. 1.Changed MULTIPLICITY check from runtime to compiletime. No loads the large Config module. 2.Changed plperl_init_interp() to return new interp and not alter the global interp_state 3. Moved plperl_safe_init() call into check_interp(). 4. Removed plperl_safe_init_done state variable as interp_state now covers that role. 5. Changed plperl_create_sub() to take a plperl_proc_desc argument. 6. Simplified return value handling in plperl_create_sub. 7. Changed perl.com link in the docs to perl.org and tweaked wording to clarify that require, not use, is what's blocked. 8. Moved perl code in large multi-line C string literal macros out to plc_*.pl files. 9. Added a test2macro.pl utility to convert the plc_*.pl files to macros in a perlchunks.h file which is #included 10. Simplifed plperl_safe_init() slightly 11. Optimized pg_verifymbstr calls to avoid unneeded strlen()s. Patch from Tim Bunce, with minor editing from me.</li>

<li>In pgsql/src/tools/msvc/Mkvcbuild.pm, build perlchunks.h for plperl on MSVC.</li>

<li>Provide regression testing for plperlu, and for plperl+plperlu interaction. The latter are only run if the platform can run both interpreters in the same backend.</li>

</ul>

<p>ITAGAKI Takahiro a commit&eacute;&nbsp;:</p>

<ul>

<li>In pgsql/src/backend/utils/adt/genfile.c, verify input in pg_read_file().</li>

<li>In pgsql/contrib/pgbench/pgbench.c, add verification of variable names in pgbench. Variables must consist of only alphabets, numerals and underscores. We had allowed to set variables with invalid names, but could not refer them in queries. Thanks to Robert Haas for the review.</li>

<li>In pgsql/contrib/pgbench/pgbench.c, adjust headers to allow pgbench to be built with PGXS.</li>

<li>Support rewritten-based full vacuum as VACUUM FULL. Traditional VACUUM FULL was renamed to VACUUM FULL INPLACE. Also added a new option -i, --inplace for vacuumdb to perform FULL INPLACE vacuuming. Since the new VACUUM FULL uses CLUSTER infrastructure, we cannot use it for system tables. VACUUM FULL for system tables always fall back into VACUUM FULL INPLACE silently. Itagaki Takahiro, reviewed by Jeff Davis and Simon Riggs.</li>

<li>In pgsql/src/backend/commands/cluster.c, silence compiler warning about uninitialized variables. This initialization is not necessary needed, but some compilers complain about it.</li>

<li>Add buffer access counters to pg_stat_statements. This uses the same infrastructure with EXPLAIN BUFFERS to support {shared|local}_blks_{hit|read|written} andtemp_blks_{read|written} columns in the pg_stat_statements view. The dumped file format also updated. Thanks to Robert Haas for the review.</li>

<li>In pgsql/src/include/executor/instrument.h, pgBufferUsage needs PGDLLIMPORT for pg_stat_statements on Windows.</li>

</ul>

<p>Michael Meskes a commit&eacute;&nbsp;:</p>

<ul>

<li>Applied patch by Zoltan Boszormenyi to add sqlda support to ecpg in both native and compatiblity mode.</li>

<li>Adjusted CVS headers for ECPG.</li>

<li>ECPG still not correct.</li>

<li>In ECPG, third try. It seems my two checkouts need some cleaning up.</li>

<li>Ah, should read the file completely. I got so used to git that I almost forgot about the cvs stuff.</li>

<li>And then forgot to commit the fixed files. ARGH!</li>

<li>And another one of the same problem.</li>

<li>And another one.</li>

<li>Applied Zoltan Boszormenyi's patch to remove hardware dependant offset logging and superfluous include files.</li>

<li>In ECPG, removed more inttypes.h stuff.</li>

<li>In ECPG, removed test case using nan as float value because printf's output for nan is OS specific with some distinguishing between signaling and quiet nans. It's not really importnat for us here anyway.</li>

<li>In ECPG, remove __FUNCTION__ keyword that is not recognized by some compilers.</li>

<li>In pgsql/src/interfaces/ecpg/ecpglib/sqlda.c, replaced int64_t with int64 as Andrew Dunstan suggested.</li>

<li>In pgsql/src/interfaces/ecpg/ChangeLog, add Zoltan Boszormenyi's recent ECPG cleanup patch.</li>

<li>Backported fix for protecting ecpg against applications freeing strings to 8.4.</li>

</ul>

<p>Robert Haas a commit&eacute;&nbsp;:</p>

<ul>

<li>Support ALTER TABLESPACE name SET/RESET ( tablespace_options ). This patch only supports seq_page_cost and random_page_cost as parameters, but it provides the infrastructure to scalably support many more. In particular, we may want to add support for effective_io_concurrency, but I'm leaving that as future work for now. Thanks to Tom Lane for design help and Alvaro Herrera for the review.</li>

<li>Improve a couple of comments relating to large object snapshot management.</li>

<li>Further fixes for per-tablespace options patch. Add missing varlena header to TableSpaceOpts structure. And, per Tom Lane, instead of calling tablespace_reloptions in CacheMemoryContext, call it in the caller's memory context and copy the value over afterwards, to reduce the chances of a session-lifetime memory leak.</li>

<li>In pgsql/src/backend/utils/cache/relcache.c, document why we copy reloptions into CacheMemoryContext after-the-fact.</li>

<li>In pgsql/doc/src/sgml/catalogs.sgml, document pg_tablespace.spcoptions. This should have been part of the original tablespace-options patch, but I overlooked the need to update this portion of the documentation.</li>

<li>Remove partial, broken support for NULL pointers when fetching attributes. Previously, fastgetattr() and heap_getattr() tested their fourth argument against a null pointer, but any attempt to use them with a literal-NULL fourth argument evaluated to *(void *)0, resulting in a compiler error. Remove these NULL tests to avoid leading future readers of this code to believe that this has a chance of working. Also clean up related legacy code in nocachegetattr(), heap_getsysattr(), and nocache_index_getattr(). The new coding standard is that any code which calls a getattr-type function or macro which takes an isnull argument MUST pass a valid boolean pointer. Per discussion with Bruce Momjian, Tom Lane, Alvaro Herrera.</li>

</ul>

<p>Bruce Momjian a commit&eacute;&nbsp;:</p>

<ul>

<li>In pgsql/src/backend/commands/tablespace.c, use OIDCHARS for oid character length, rather than '10', in tablespace code.</li>

<li>Remove tabs in SGML. Move OIDCHARS to proper include file.</li>

<li>Implement pg_dump --only-analyze for use by pg_migrator to only analyze all databases.</li>

<li>Preserve relfilenodes: Add support to pg_dump --binary-upgrade to preserve all relfilenodes, for use by pg_migrator.</li>

<li>In pgsql/src/include/catalog/catversion.h, update catalog version for recent relfilenode patch, so pg_migrator can identify the new API.</li>

<li>In pgsql/src/bin/pg_dump/pg_dumpall.c, remove erroneous comma added to pg_dumpall tablespace query when running with PG version 8.2-8.4.</li>

<li>binary upgrade: Preserve relfilenodes for views and composite types --- even though we don't store data in, them, they do consume relfilenodes. Bump catalog version.</li>

<li>In pgsql/src/bin/scripts/vacuumdb.c, corrected CVS entry: --only-analyze mode is for _vacuumdb_, not pg_dump.</li>

<li>PG_MAJORVERSION: For simplicity, use PG_MAJORVERSION rather than PG_VERSION for creation of the PG_VERSION file.</li>

<li>In pgsql/src/backend/commands/tablespace.c, clarify tablespace.c::TablespaceCreateDbspace() comments.</li>

<li>In pgsql/src/backend/commands/tablespace.c, more tablespace.c comment improvements.</li>

<li>Rename new vacuumdb option to --analyze-only from --only-analyze.</li>

<li>Use -Z for vacuumdb --analyze-only, rather than -o.</li>

</ul>

<p>Simon Riggs a commit&eacute;&nbsp;:</p>

<ul>

<li>During Hot Standby, set DatabasePath correctly during relcache init file deletion, so that we attempt to unlink the correct filepath. unlink() errors are ignorable there, so lack of a DatabasePath initialization step did not cause visible problems until a related bug showed up on Solaris. Code refactored from xact_redo_commit() to ProcessCommittedInvalidationMessages() in inval.c. Recovery may replay shared invalidation messages for many databases, so we cannot SetDatabasePath() once as we do in normal backends. Read the databaseid from the shared invalidation messages, then set DatabasePath temporarily before calling RelationCacheInitFileInvalidate(). Problem report by Robert Treat, analysis and fix by me.</li>

<li>During Hot Standby, fix drop database when sessions idle. Previously we only cancelled sessions that were in-transaction. Simple fix is to just cancel all sessions without waiting. Doing it this way avoids complicating common code paths, which would not be worth the trouble to cover this rare case. Problem report and fix by Andres Freund, edited somewhat by me</li>

<li>In pgsql/doc/src/sgml/backup.sgml, docs for behaviour change of drop database during Hot Standby Adding missing docs for previous Hot Standby patch.</li>

</ul>

<p><strong>Correctifs rejet&eacute;s (&agrave; ce jour)</strong></p>

<ul>

<li>Pas de d&eacute;ception cette semaine&nbsp;:-)</li>

</ul>

<p><strong>Correctifs en attente</strong></p>

<ul>

<li>KaiGai Kohei sent in another revision of the patch to disallow ALTER TABLE...ALTER COLUMN...RENAME TO... in situations where the column originates from more than one distinct parent in its inheritance hierarchy.</li>

<li>Hitoshi Harada sent in another revision of the patch to extend windowing functions to include (ROWS|RANGE) (PRECEDING|FOLLOWING).</li>

<li>Zoltan Boszormenyi sent in another revision of the patch to add DESCRIBE OUTPUT to ECPG.</li>

<li>Guillaume Lelarge sent in two approaches to the patch which lets libpq have named parameters.</li>

<li>Robert Haas sent in two WIP patches to add attribute options, following the model of reloptions and tablespace options.</li>

<li>Pavel Stehule sent in another revision of the patch to add quote_literal and quote_ident behavior to psql variables.</li>

<li>Fujii Masao sent in another revision of the patch to add a new transaction log record which indicates that a WAL has been skipped.</li>

<li>Marko (johto) Tiikkaja sent in another revision of the writeable CTE patch, this time allowing INSERT, UPDATE or DELETE at the top level.</li>

<li>Magnus Hagander sent in a patch which fixes an issue in the win32 socket definition.</li>

<li>Arie Bikker sent in three revisions of a patch to improve xpath queries.</li>

<li>Fujii Masao sent in a patch to add a "replication" keyword to pg_hba.conf.</li>

<li>John Naylor sent in another patch to fix the BKI refactor patch.</li>

<li>Simon Riggs sent in a patch to fix an issue in hot standby where cancelling queries misbehaved.</li>

<li>Alex Hunsaker sent in a patch to set oom to -17 in the startup script so the OOM killer won't kill.</li>

<li>ITAGAKI Takahiro sent in a patch to fix an issue where paths have non-ASCII characters.</li>

<li>Leonardo F sent in a patch to add substring and replace() to bit values.</li>

<li>Alex Hunsaker sent in a patch to avoid the Linux OOM killer.</li>

<li>Joachim Wieland sent in another revision of the patch to fix cases in LISTEN/NOTIFY when the queue is full</li>

<li>Kevin Grittner sent in a patch intended to be infrastructure for a better implementation of SERIALIZABLE isolation.</li>

<li>Tim Bunce sent in a patch which adds a flock of features to PL/Perl.</li>

<li>Joachim Wieland sent in a patch which implements synchronized snapshots, which will among other things allow pg_dump to work in parallel.</li>

<li>Heikki Linnakangas sent in another revsion of the streaming replication patch.</li>

<li>Magnus Hagander sent in a patch to enable RADIUS authentication.</li>

<li>Peter Eisentraut sent in a patch to implement typed tables per SQL:2008.</li>

</ul>