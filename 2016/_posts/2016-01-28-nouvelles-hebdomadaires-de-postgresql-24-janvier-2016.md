---
layout: post
title: "Nouvelles hebdomadaires de PostgreSQL - 24 janvier 2016"
author: "NBougain"
redirect_from: "index.php?post/2016-01-28-nouvelles-hebdomadaires-de-postgresql-24-janvier-2016 "
---


<p>La 8<sup>&egrave;me</sup> Session PostgreSQL aura lieu le 6 avril 2016 &agrave; Lyon (France). L'appel &agrave; conf&eacute;renciers court jusqu'au 29 f&eacute;vrier &agrave; l'adresse call-for-paper AT postgresql-sessions POINT org.</p>

<h2>Les nouveaut&eacute;s des produits d&eacute;riv&eacute;s</h2>

<ul>

<li>pgBadger 7.3, un analyseur de log PostgreSQL parall&eacute;lisable &eacute;crit en Perl&nbsp;: <a target="_blank" href="http://dalibo.github.io/pgbadger/">http://dalibo.github.io/pgbadger/</a><br>

D&eacute;veloppement&nbsp;: <a target="_blank" href="https://github.com/dalibo/pgbadger/">https://github.com/dalibo/pgbadger/</a></li>

<li>PyGreSQL 4.2, un driver Python pour PostgreSQL&nbsp;: <a target="_blank" href="http://www.pygresql.org/">http://www.pygresql.org/</a></li>

</ul>

<h2>Offres d'emplois autour de PostgreSQL en janvier</h2>

<ul>

<li>Internationales : <a target="_blank" href="http://archives.postgresql.org/pgsql-jobs/2016-01/">http://archives.postgresql.org/pgsql-jobs/2016-01/</a></li>

<li>Francophones : <a target="_blank" href="http://forums.postgresql.fr/viewforum.php?id=4">http://forums.postgresql.fr/viewforum.php?id=4</a></li>

</ul>

<h2>PostgreSQL Local</h2>

<ul>

<li>FOSDEM PGDay est une conf&eacute;rence d'une journ&eacute;e qui sera tenue avant le FOSDEM &agrave; Bruxelles (Belgique) le 29 janvier 2015. Les inscriptions sont encore ouvertes&nbsp;: <a target="_blank" href="http://fosdem2016.pgconf.eu/">http://fosdem2016.pgconf.eu/</a></li>

<li>Prague PostgreSQL Developer Day 2016 (P2D2 2016) est une conf&eacute;rence sur deux jours, les 17 et 18 f&eacute;vrier 2016, &agrave; Prague (R&eacute;publique Tch&egrave;que). Site en tch&egrave;que&nbsp;: <a target="_blank" href="http://www.p2d2.cz/">http://www.p2d2.cz/</a></li>

<li>Le PGday annuel indien se tiendra &agrave; Bangalore (&Eacute;tat du Karnataka en Inde) le 26 f&eacute;vrier 2016&nbsp;: <a target="_blank" href="http://pgday.in">http://pgday.in</a></li>

<li>La premi&egrave;re conf&eacute;rence PostgreSQL pan-asiatique se tiendra les 16 et 17 mars 2016 &agrave; Singapour&nbsp;: <a target="_blank" href="http://2016.pgday.asia/">http://2016.pgday.asia/</a></li>

<li>Le PGDay nordique, une s&eacute;rie de conf&eacute;rences sur une seule journ&eacute;e, aura lieu &agrave; Helsinki (Finlande) le 17 mars 2016. Les inscriptions sont encore ouvertes&nbsp;: <a target="_blank" href="http://2016.nordicpgday.org/">http://2016.nordicpgday.org/</a></li>

<li>La <em>PGConf US 2016</em> aura lieu les 18, 19 et 20 avril &agrave; New-York. L'appel &agrave; conf&eacute;renciers expire au 31 janvier 2016, 23:59EST&nbsp;: <a target="_blank" href="http://www.pgconf.us/2016/">http://www.pgconf.us/2016/</a></li>

<li>La <em>LinuxFest Northwest</em> aura lieu les 23 et 24 avril 2016 au Coll&egrave;ge Technique de Bellingham (Washington, USA). L'appel &agrave; conf&eacute;renciers est maintenant lanc&eacute;&nbsp;: <a target="_blank" href="http://www.linuxfestnorthwest.org/2016/present">http://www.linuxfestnorthwest.org/2016/present</a></li>

<li>FOSS4G NA (<em>Free and Open Source Software for Geospatial - North America</em>) se tiendra &agrave; Raleigh, en Caroline du Nord, du 2 au 5 mai 2016. L'appel &agrave; conf&eacute;renciers est lanc&eacute;&nbsp;: <a target="_blank" href="https://2016.foss4g-na.org/cfp">https://2016.foss4g-na.org/cfp</a></li>

<li>La <em>PGCon 2016</em> se tiendra du 17 au 21 mai 2016 &agrave; Ottawa&nbsp;: <a target="_blank" href="http://www.pgcon.org/">http://www.pgcon.org/</a></li>

<li>Le PGDay suisse sera, cette ann&eacute;e, tenue &agrave; l'Universit&eacute; des Sciences Appliqu&eacute;es (HSR) de Rapperswil le 24 juin 2016. L'appel &agrave; conf&eacute;renciers est lanc&eacute;&nbsp;: <a target="_blank" href="http://www.pgday.ch/">http://www.pgday.ch/</a></li>

</ul>

<h2>PostgreSQL dans les m&eacute;dia</h2>

<ul>

<li>Planet PostgreSQL : <a target="_blank" href="http://planet.postgresql.org/">http://planet.postgresql.org/</a></li>

<li>Planet PostgreSQLFr : <a target="_blank" href="http://planete.postgresql.fr/">http://planete.postgresql.fr/</a></li>

</ul>

<p>PostgreSQL Weekly News / les nouvelles hebdomadaires vous sont offertes cette semaine par David Fetter. Traduction par l'&eacute;quipe PostgreSQLFr sous licence CC BY-NC-SA. La version originale se trouve &agrave; l'adresse suivante : <a target="_blank" href="http://www.postgresql.org/message-id/20160125053004.GA10201@fetter.org">http://www.postgresql.org/message-id/20160125053004.GA10201@fetter.org</a></p>

<p>Proposez vos articles ou annonces avant dimanche 15:00 (heure du Pacifique). Merci de les envoyer en anglais &agrave; david (a) fetter.org, en allemand &agrave; pwn (a) pgug.de, en italien &agrave; pwn (a) itpug.org et en espagnol &agrave; pwn (a) arpug.com.ar.</p>

<!--more-->


<h2>Correctifs appliqu&eacute;s</h2>

<p>Tom Lane pushed:</p>

<ul>

<li>Re-pgindent a few files. In preparation for landing index AM interface changes. <a target="_blank" href="http://git.postgresql.org/pg/commitdiff/8d290c8ec6c182a4df1d089c21fe84c7912f01fe">http://git.postgresql.org/pg/commitdiff/8d290c8ec6c182a4df1d089c21fe84c7912f01fe</a></li>

<li>Restructure index access method API to hide most of it at the C level. This patch reduces pg_am to just two columns, a name and a handler function. All the data formerly obtained from pg_am is now provided in a C struct returned by the handler function. This is similar to the designs we've adopted for FDWs and tablesample methods. There are multiple advantages. For one, the index AM's support functions are now simple C functions, making them faster to call and much less error-prone, since the C compiler can now check function signatures. For another, this will make it far more practical to define index access methods in installable extensions. A disadvantage is that SQL-level code can no longer see attributes of index AMs; in particular, some of the crosschecks in the opr_sanity regression test are no longer possible from SQL. We've addressed that by adding a facility for the index AM to perform such checks instead. (Much more could be done in that line, but for now we're content if the amvalidate functions more or less replace what opr_sanity used to do.) We might also want to expose some sort of reporting functionality, but this patch doesn't do that. Alexander Korotkov, reviewed by Petr Jel&Atilde;&shy;nek, and rather heavily editorialized on by me. <a target="_blank" href="http://git.postgresql.org/pg/commitdiff/65c5fcd353a859da9e61bfb2b92a99f12937de3b">http://git.postgresql.org/pg/commitdiff/65c5fcd353a859da9e61bfb2b92a99f12937de3b</a></li>

<li>Add explicit cast to amcostestimate call. My compiler doesn't complain here, but David Rowley's does ... <a target="_blank" href="http://git.postgresql.org/pg/commitdiff/49b49506502026a3653bca490c939dc8934afe95">http://git.postgresql.org/pg/commitdiff/49b49506502026a3653bca490c939dc8934afe95</a></li>

<li>Fix assorted inconsistencies in GiST opclass support function declarations. The conventions specified by the GiST SGML documentation were widely ignored. For example, the strategy-number argument for "consistent" and "distance" functions is specified to be a smallint, but most of the built-in support functions declared it as an integer, and for that matter the core code passed it using Int32GetDatum not Int16GetDatum. None of that makes any real difference at runtime, but it's quite confusing for newcomers to the code, and it makes it very hard to write an amvalidate() function that checks support function signatures. So let's try to instill some consistency here. Another similar issue is that the "query" argument is not of a single well-defined type, but could have different types depending on the strategy (corresponding to search operators with different righthand-side argument types). Some of the functions threw up their hands and declared the query argument as being of "internal" type, which surely isn't right ("any" would have been more appropriate); but the majority position seemed to be to declare it as being of the indexed data type, corresponding to a search operator with both input types the same. So I've specified a convention that that's what to do always. Also, the result of the "union" support function actually must be of the index's storage type, but the documentation suggested declaring it to return "internal", and some of the functions followed that. Standardize on telling the truth, instead. Similarly, standardize on declaring the "same" function's inputs as being of the storage type, not "internal". Also, somebody had forgotten to add the "recheck" argument to both the documentation of the "distance" support function and all of their SQL declarations, even though the C code was happily using that argument. Clean that up too. Fix up some other omissions in the docs too, such as documenting that union's second input argument is vestigial. So far as the errors in core function declarations go, we can just fix pg_proc.h and bump catversion. Adjusting the erroneous declarations in contrib modules is more debatable: in principle any change in those scripts should involve an extension version bump, which is a pain. However, since these changes are purely cosmetic and make no functional difference, I think we can get away without doing that. <a target="_blank" href="http://git.postgresql.org/pg/commitdiff/9ff60273e35cad6e9d3a4adf59d5c2455afe9d9e">http://git.postgresql.org/pg/commitdiff/9ff60273e35cad6e9d3a4adf59d5c2455afe9d9e</a></li>

<li>Fix assorted inconsistencies in GIN opclass support function declarations. GIN had some minor issues too, mostly using "internal" where something else would be more appropriate. I went with the same approach as in 9ff60273e35cad6e, namely preferring the opclass' indexed datatype for arguments that receive an operator RHS value, even if that's not necessarily what they really are. Again, this is with an eye to having a uniform rule for ginvalidate() to check support function signatures. <a target="_blank" href="http://git.postgresql.org/pg/commitdiff/dbe2328959e12701fade6b500ad411271923d6e4">http://git.postgresql.org/pg/commitdiff/dbe2328959e12701fade6b500ad411271923d6e4</a></li>

<li>Add defenses against putting expanded objects into Const nodes. Putting a reference to an expanded-format value into a Const node would be a bad idea for a couple of reasons. It'd be possible for the supposedly immutable Const to change value, if something modified the referenced variable ... in fact, if the Const's reference were R/W, any function that has the Const as argument might itself change it at runtime. Also, because datumIsEqual() is pretty simplistic, the Const might fail to compare equal to other Consts that it should compare equal to, notably including copies of itself. This could lead to unexpected planner behavior, such as "could not find pathkey item to sort" errors or inferior plans. I have not been able to find any way to get an expanded value into a Const within the existing core code; but Paul Ramsey was able to trigger the problem by writing a datatype input function that returns an expanded value. The best fix seems to be to establish a rule that varlena values being placed into Const nodes should be passed through pg_detoast_datum(). That will do nothing (and cost little) in normal cases, but it will flatten expanded values and thereby avoid the above problems. Also, it will convert short-header or compressed values into canonical format, which will avoid possible unexpected lack-of-equality issues for those cases too. And it provides a last-ditch defense against putting a toasted value into a Const, which we already knew was dangerous, cf commit 2b0c86b66563cf2f. (In the light of this discussion, I'm no longer sure that that commit provided 100% protection against such cases, but this fix should do it.) The test added in commit 65c3d05e18e7c530 to catch datatype input functions with unstable results would fail for functions that returned expanded values; but it seems a bit uncharitable to deem a result unstable just because it's expressed in expanded form, so revise the coding so that we check for bitwise equality only after applying pg_detoast_datum(). That's a sufficient condition anyway given the new rule about detoasting when forming a Const. Back-patch to 9.5 where the expanded-object facility was added. It's possible that this should go back further; but in the absence of clear evidence that there's any live bug in older branches, I'll refrain for now. <a target="_blank" href="http://git.postgresql.org/pg/commitdiff/b99551832e79c915e4d877cf0a072120bd248748">http://git.postgresql.org/pg/commitdiff/b99551832e79c915e4d877cf0a072120bd248748</a></li>

<li>Suppress compiler warning. Given the limited range of i, these shifts should not cause any problem, but that apparently doesn't stop some compilers from whining about them. David Rowley <a target="_blank" href="http://git.postgresql.org/pg/commitdiff/d9b9289c837a98b78b948b597fabd9ab0a96c0db">http://git.postgresql.org/pg/commitdiff/d9b9289c837a98b78b948b597fabd9ab0a96c0db</a></li>

<li>Improve index AMs' opclass validation procedures. The amvalidate functions added in commit 65c5fcd353a859da were on the crude side. Improve them in a few ways: * Perform signature checking for operators and support functions. * Apply more thorough checks for missing operators and functions, where possible. * Instead of reporting problems as ERRORs, report most problems as INFO messages and make the amvalidate function return FALSE. This allows more than one problem to be discovered per run. * Report object names rather than OIDs, and work a bit harder on making the messages understandable. Also, remove a few more opr_sanity regression test queries that are now superseded by the amvalidate checks. <a target="_blank" href="http://git.postgresql.org/pg/commitdiff/be44ed27b86ebd165bbedf06a4ac5a8eb943d43c">http://git.postgresql.org/pg/commitdiff/be44ed27b86ebd165bbedf06a4ac5a8eb943d43c</a></li>

<li>Make extract() do something more reasonable with infinite datetimes. Historically, extract() just returned zero for any case involving an infinite timestamp[tz] input; even cases in which the unit name was invalid. This is not very sensible. Instead, return infinity or -infinity as appropriate when the requested field is one that is monotonically increasing (e.g, year, epoch), or NULL when it is not (e.g., day, hour). Also, throw the expected errors for bad unit names. BACKWARDS INCOMPATIBLE CHANGE Vitaly Burovoy, reviewed by Vik Fearing <a target="_blank" href="http://git.postgresql.org/pg/commitdiff/647d87c56ab6da70adb753c08d7cdf7ee905ea8a">http://git.postgresql.org/pg/commitdiff/647d87c56ab6da70adb753c08d7cdf7ee905ea8a</a></li>

<li>Remove new coupling between NAMEDATALEN and MAX_LEVENSHTEIN_STRLEN. Commit e529cd4ffa605c6f introduced an Assert requiring NAMEDATALEN to be less than MAX_LEVENSHTEIN_STRLEN, which has been 255 for a long time. Since up to that instant we had always allowed NAMEDATALEN to be substantially more than that, this was ill-advised. It's debatable whether we need MAX_LEVENSHTEIN_STRLEN at all (versus putting a CHECK_FOR_INTERRUPTS into the loop), or whether it has to be so tight; but this patch takes the narrower approach of just not applying the MAX_LEVENSHTEIN_STRLEN limit to calls from the parser. Trusting the parser for this seems reasonable, first because the strings are limited to NAMEDATALEN which is unlikely to be hugely more than 256, and second because the maximum distance is tightly constrained by MAX_FUZZY_DISTANCE (though we'd forgotten to make use of that limit in one place). That means the cost is not really O(mn) but more like O(max(m,n)). Relaxing the limit for user-supplied calls is left for future research; given the lack of complaints to date, it doesn't seem very high priority. In passing, fix confusion between lengths-in-bytes and lengths-in-chars in comments and error messages. Per gripe from Kevin Day; solution suggested by Robert Haas. Back-patch to 9.5 where the unwanted restriction was introduced. <a target="_blank" href="http://git.postgresql.org/pg/commitdiff/a396144ac03b0cf337f80201df7e4663cc5a8131">http://git.postgresql.org/pg/commitdiff/a396144ac03b0cf337f80201df7e4663cc5a8131</a></li>

<li>Improve levenshtein() docs. Fix chars-vs-bytes confusion here too. Improve poor grammar and markup. <a target="_blank" href="http://git.postgresql.org/pg/commitdiff/80aa219146c090d46b599ac40d8d63e30532b622">http://git.postgresql.org/pg/commitdiff/80aa219146c090d46b599ac40d8d63e30532b622</a></li>

<li>Improve cross-platform consistency of Inf/NaN handling in trig functions. Ensure that the trig functions return NaN for NaN input regardless of what the underlying C library functions might do. Also ensure that an error is thrown for Inf (or otherwise out-of-range) input, except for atan/atan2 which should accept it. All these behaviors should now conform to the POSIX spec; previously, all our popular platforms deviated from that in one case or another. The main remaining platform dependency here is whether the C library might choose to throw a domain error for sin/cos/tan inputs that are large but less than infinity. (Doing so is not unreasonable, since once a single unit-in-the-last-place exceeds PI, there can be no significance at all in the result; however there doesn't seem to be any suggestion in POSIX that such an error is allowed.) We will report such errors if they are reported via "errno", but not if they are reported via "fetestexcept" which is the other mechanism sanctioned by POSIX. Some preliminary experiments with fetestexcept indicated that it might also report errors we could do without, such as complaining about underflow at an unreasonably large threshold. So let's skip that complexity for now. Dean Rasheed, reviewed by Michael Paquier <a target="_blank" href="http://git.postgresql.org/pg/commitdiff/fd5200c3dca0bc725f5848eef7ffff538f4479ed">http://git.postgresql.org/pg/commitdiff/fd5200c3dca0bc725f5848eef7ffff538f4479ed</a></li>

<li>Add trigonometric functions that work in degrees. The implementations go to some lengths to deliver exact results for values where an exact result can be expected, such as sind(30) = 0.5 exactly. Dean Rasheed, reviewed by Michael Paquier <a target="_blank" href="http://git.postgresql.org/pg/commitdiff/e1bd684a34c11139a1bf4e5200c3bbe59a0fbfad">http://git.postgresql.org/pg/commitdiff/e1bd684a34c11139a1bf4e5200c3bbe59a0fbfad</a></li>

<li>Adjust degree-based trig functions for more portability. The buildfarm isn't very happy with the results of commit e1bd684a34c11139. To try to get the expected exact results everywhere: * Replace M_PI / 180 subexpressions with a precomputed constant, so that the compiler can't decide to rearrange that division with an adjacent operation. Hopefully this will fix failures to get exactly 0.5 from sind(30) and cosd(60). * Add scaling to ensure that tand(45) and cotd(45) give exactly 1; there was nothing particularly guaranteeing that before. * Replace minus zero by zero when tand() or cotd() would output that; many machines did so for tand(180) and cotd(270), but not all. We could alternatively deem both results valid, but that doesn't seem likely to be what users will want. <a target="_blank" href="http://git.postgresql.org/pg/commitdiff/73193d82d7c8d849774bf6952dfb4287e213c572">http://git.postgresql.org/pg/commitdiff/73193d82d7c8d849774bf6952dfb4287e213c572</a></li>

<li>Further adjust degree-based trig functions for more portability. The last round didn't do it. Per Noah Misch, the problem on at least some machines is that the compiler pre-evaluates trig functions having constant arguments using code slightly different from what will be used at runtime. Therefore, we must prevent the compiler from seeing constant arguments to any of the libm trig functions used in this code. The method used here might still fail if init_degree_constants() gets inlined into the call sites. That probably won't happen given the large number of call sites; but if it does, we could probably fix it by making init_degree_constants() non-static. I'll avoid that till proven necessary, though. <a target="_blank" href="http://git.postgresql.org/pg/commitdiff/65abaab547a5758b0d6d92df4af1663bb47d545f">http://git.postgresql.org/pg/commitdiff/65abaab547a5758b0d6d92df4af1663bb47d545f</a></li>

<li>Still further adjust degree-based trig functions for more portability. Indeed, the non-static declaration foreseen in my previous commit message is necessary. Per Noah Misch. <a target="_blank" href="http://git.postgresql.org/pg/commitdiff/360f67d31a5656991122b89c9ca22a860f41512c">http://git.postgresql.org/pg/commitdiff/360f67d31a5656991122b89c9ca22a860f41512c</a></li>

<li>Yet further adjust degree-based trig functions for more portability. Buildfarm member cockatiel is still saying that cosd(60) isn't 0.5. What seems likely is that the subexpression (1.0 - cos(x)) isn't being rounded to double width before more arithmetic is done on it, so force that by storing it into a variable. <a target="_blank" href="http://git.postgresql.org/pg/commitdiff/00347575e2754b1aaacd357776560803564d3f35">http://git.postgresql.org/pg/commitdiff/00347575e2754b1aaacd357776560803564d3f35</a></li>

</ul>

<p>Tatsuo Ishii pushed:</p>

<ul>

<li>Fix typo. Reported by KOIZUMI Satoru. <a target="_blank" href="http://git.postgresql.org/pg/commitdiff/85f22281a1190165851f15b35f8283c8b7592b3c">http://git.postgresql.org/pg/commitdiff/85f22281a1190165851f15b35f8283c8b7592b3c</a></li>

</ul>

<p>Andrew Dunstan pushed:</p>

<ul>

<li>Remove Cygwin-specific code from pg_ctl This code has been there for a long time, but it's never really been needed. Cygwin has its own utility for registering, unregistering, stopping and starting Windows services, and that's what's used in the Cygwin postgres packages. So now pg_ctl for Cygwin looks like it is for any Unix platform. Michael Paquier and me <a target="_blank" href="http://git.postgresql.org/pg/commitdiff/53c949c1be2f43cd47cb433923e76ea00e9222bc">http://git.postgresql.org/pg/commitdiff/53c949c1be2f43cd47cb433923e76ea00e9222bc</a></li>

</ul>

<p>&Atilde;lvaro Herrera pushed:</p>

<ul>

<li>Add two HyperLogLog functions. New functions initHyperLogLogError() and freeHyperLogLog() simplify using this module from elsewhere. Author: Tom&Atilde;&iexcl;&Aring;&iexcl; Vondra. Review: Peter Geoghegan <a target="_blank" href="http://git.postgresql.org/pg/commitdiff/948c97958bf37adb2a9c2d6d92c255abfc7499ba">http://git.postgresql.org/pg/commitdiff/948c97958bf37adb2a9c2d6d92c255abfc7499ba</a></li>

<li>PostgresNode: Add names to nodes. This makes the log files easier to follow when investigating a test failure. Author: Michael Paquier. Review: Noah Misch <a target="_blank" href="http://git.postgresql.org/pg/commitdiff/c8642d909fdd57c36dd71e0b0bb4071523324794">http://git.postgresql.org/pg/commitdiff/c8642d909fdd57c36dd71e0b0bb4071523324794</a></li>

<li>pg_dump: Fix quoting of domain constraint names. The original code was adding double quotes to an already-quoted identifier, leading to nonsensical results. Remove the quoting call. I introduced the broken code in 7eca575d1c of 9.5 era, so backpatch to 9.5. Report and patch by Elvis Pranskevichus Reviewed by Michael Paquier <a target="_blank" href="http://git.postgresql.org/pg/commitdiff/df43fcf4575cf77d85f4c4dcc096661905a6eb33">http://git.postgresql.org/pg/commitdiff/df43fcf4575cf77d85f4c4dcc096661905a6eb33</a></li>

</ul>

<p>Bruce Momjian pushed:</p>

<ul>

<li>Properly install dynloader.h on MSVC builds. This will enable PL/Java to be cleanly compiled, as dynloader.h is a requirement. Report by Chapman Flack Patch by Michael Paquier Backpatch through 9.1 <a target="_blank" href="http://git.postgresql.org/pg/commitdiff/216d5684325dd2f6959f4859648e7aa908ae0757">http://git.postgresql.org/pg/commitdiff/216d5684325dd2f6959f4859648e7aa908ae0757</a></li>

</ul>

<p>Robert Haas pushed:</p>

<ul>

<li>Support multi-stage aggregation. Aggregate nodes now have two new modes: a "partial" mode where they output the unfinalized transition state, and a "finalize" mode where they accept unfinalized transition states rather than individual values as input. These new modes are not used anywhere yet, but they will be necessary for parallel aggregation. The infrastructure also figures to be useful for cases where we want to aggregate local data and remote data via the FDW interface, and want to bring back partial aggregates from the remote side that can then be combined with locally generated partial aggregates to produce the final value. It may also be useful even when neither FDWs nor parallelism are in play, as explained in the comments in nodeAgg.c. David Rowley and Simon Riggs, reviewed by KaiGai Kohei, Heikki Linnakangas, Haribabu Kommi, and me. <a target="_blank" href="http://git.postgresql.org/pg/commitdiff/a7de3dc5c346e07e0439275982569996e645b3c2">http://git.postgresql.org/pg/commitdiff/a7de3dc5c346e07e0439275982569996e645b3c2</a></li>

<li>Support parallel joins, and make related improvements. The core innovation of this patch is the introduction of the concept of a partial path; that is, a path which if executed in parallel will generate a subset of the output rows in each process. Gathering a partial path produces an ordinary (complete) path. This allows us to generate paths for parallel joins by joining a partial path for one side (which at the baserel level is currently always a Partial Seq Scan) to an ordinary path on the other side. This is subject to various restrictions at present, especially that this strategy seems unlikely to be sensible for merge joins, so only nested loops and hash joins paths are generated. This also allows an Append node to be pushed below a Gather node in the case of a partitioned table. Testing revealed that early versions of this patch made poor decisions in some cases, which turned out to be caused by the fact that the original cost model for Parallel Seq Scan wasn't very good. So this patch tries to make some modest improvements in that area. There is much more to be done in the area of generating good parallel plans in all cases, but this seems like a useful step forward. Patch by me, reviewed by Dilip Kumar and Amit Kapila. <a target="_blank" href="http://git.postgresql.org/pg/commitdiff/45be99f8cd5d606086e0a458c9c72910ba8a613d">http://git.postgresql.org/pg/commitdiff/45be99f8cd5d606086e0a458c9c72910ba8a613d</a></li>

</ul>

<p>Simon Riggs pushed:</p>

<ul>

<li>Refactor to create generic WAL page read callback. Previously we didn&acirc;&euro;&trade;t have a generic WAL page read callback function, surprisingly. Logical decoding has logical_read_local_xlog_page(), which was actually generic, so move that to xlogfunc.c and rename to read_local_xlog_page(). Maintain logical_read_local_xlog_page() so existing callers still work. As requested by Michael Paquier, Alvaro Herrera and Andres Freund <a target="_blank" href="http://git.postgresql.org/pg/commitdiff/422a55a68784fd00f4514834f3649140a9166fa5">http://git.postgresql.org/pg/commitdiff/422a55a68784fd00f4514834f3649140a9166fa5</a></li>

<li>Speedup 2PC by skipping two phase state files in normal path. 2PC state info is written only to WAL at PREPARE, then read back from WAL at COMMIT PREPARED/ABORT PREPARED. Prepared transactions that live past one bufmgr checkpoint cycle will be written to disk in the same form as previously. Crash recovery path is not altered. Measured performance gains of 50-100% for short 2PC transactions by completely avoiding writing files and fsyncing. Other optimizations still available, further patches in related areas expected. Stas Kelvich and heavily edited by Simon Riggs Based upon earlier ideas and patches by Michael Paquier and Heikki Linnakangas, a concrete example of how Postgres-XC has fed back ideas into PostgreSQL. Reviewed by Michael Paquier, Jeff Janes and Andres Freund Performance testing by Jesper Pedersen <a target="_blank" href="http://git.postgresql.org/pg/commitdiff/978b2f65aa1262eb4ecbf8b3785cb1b9cf4db78e">http://git.postgresql.org/pg/commitdiff/978b2f65aa1262eb4ecbf8b3785cb1b9cf4db78e</a></li>

<li>Refactor headers to split out standby defs Jeff Janes <a target="_blank" href="http://git.postgresql.org/pg/commitdiff/c80b31d557cb4b2d2a65cb0a7e71fd961834fdb2">http://git.postgresql.org/pg/commitdiff/c80b31d557cb4b2d2a65cb0a7e71fd961834fdb2</a></li>

<li>Correct comment in GetConflictingVirtualXIDs() We use Share lock because it is safe to do so. <a target="_blank" href="http://git.postgresql.org/pg/commitdiff/1129c2b0ad2732f301f696ae2cf98fb063a4c1f8">http://git.postgresql.org/pg/commitdiff/1129c2b0ad2732f301f696ae2cf98fb063a4c1f8</a></li>

</ul>

<p>Peter Eisentraut pushed:</p>

<ul>

<li>psql: Add tab completion for COPY with query. From: Andreas Karlsson &lt;andreas@proxel.se&gt; <a target="_blank" href="http://git.postgresql.org/pg/commitdiff/d0f2f53cd6f2f1fe6e53b8e3bfcce43c16ea851b">http://git.postgresql.org/pg/commitdiff/d0f2f53cd6f2f1fe6e53b8e3bfcce43c16ea851b</a></li>

<li>psql: Improve completion of FDW DDL commands. Add ALTER FOREIGN DATA WRAPPER -&gt; RENAME TO, ALTER SERVER -&gt; RENAME TO, ALTER SERVER ... VERSION ... -&gt; OPTIONS, CREATE FOREIGN DATA WRAPPER -&gt; OPTIONS , CREATE SERVER -&gt; OPTIONS, CREATE|ALTER USER MAPPING -&gt; OPTIONS From: Andreas Karlsson &lt;andreas@proxel.se&gt; <a target="_blank" href="http://git.postgresql.org/pg/commitdiff/6ae4c8de00c382b10e851e1eaf7f5e19e143b251">http://git.postgresql.org/pg/commitdiff/6ae4c8de00c382b10e851e1eaf7f5e19e143b251</a></li>

</ul>

<p>Fujii Masao pushed:</p>

<ul>

<li>Remove unused argument from ginInsertCleanup() It's an oversight in commit dc943ad. <a target="_blank" href="http://git.postgresql.org/pg/commitdiff/38710a374ea9a29159ff12af7dbecd2959476447">http://git.postgresql.org/pg/commitdiff/38710a374ea9a29159ff12af7dbecd2959476447</a></li>

</ul>

<h2>Correctifs rejet&eacute;s (&agrave; ce jour)</h2>

<p>No one was disappointed this week :-)</p>

<h2>Correctifs en attente</h2>

<p>Alexander Shulgin sent in a patch to fix some IDENTIFICATION divisions.</p>

<p>Dmitry Dolgov sent in another revision of a patch to add array-style subscripting to JSONB.</p>

<p>Tomas Vondra sent in another revision of a patch to add multivariate statistics.</p>

<p>Bruce Momjian and Joe Conway traded patches to expose pg_controldata and pg_config as functions.</p>

<p>Artur Zakirov sent in two more revisions of a patch to implement fuzzy substring searching with the pg_trgm extension.</p>

<p>Ashutosh Bapat sent in two more revisions of a patch to add postgres_fdw join pushdown.</p>

<p>Vitaly Burovoy and Pavel St&Auml;&rsaquo;hule traded patches to add a custom function for converting human readable sizes to bytes.</p>

<p>Dilip Kumar sent in another revision of a patch to move PinBuffer and UnpinBuffer to atomics.</p>

<p>Thomas Munro sent in another revision of a patch to add causal reads.</p>

<p>SAWADA Masahiko sent in another revision of a patch to allow multiple synchronous standby servers.</p>

<p>Alexander Shulgin sent in another revision of a patch to add an extension called pg_logical_slot_stream_relation.</p>

<p>Tatsuo Ishii sent in a patch to fix a too-enthusiastic quoting of identifiers with the high bit set.</p>

<p>Anastasia Lubennikova sent in two more revisions of a patch to implement covering unique indexes.</p>

<p>Robert Haas and Etsuro Fujita traded patches to optimize write operations on the PostgreSQL FDW.</p>

<p>Haribabu Kommi sent in two more revisions of a patch to do aggregation in parallel.</p>

<p>David Rowley sent in another revision of a patch to serialize internal aggregate states.</p>

<p>Haribabu Kommi sent in two more revisions of a patch to add combine functions for staged aggregates.</p>

<p>Kyotaro HORIGUCHI sent in another revision of a patch to allow async-capable nodes to register callbacks to run the node before ExecProcNode() and provide an example using same.</p>

<p>Etsuro Fujita sent in another revision of a patch to optimize create_foreignscan_plan/ExecInitForeignScan.</p>

<p>Daniel Verit&Atilde;&copy; sent in another revision of a patch to add a \crosstabview to psql.</p>

<p>Tomas Vondra and David Rowley traded patches to optimize outer joins where the outer side is unique.</p>

<p>Petr Jel&Atilde;&shy;nek sent in another revision of a patch to enable generic WAL logical messages.</p>

<p>David Rowley sent in a patch to fix an issue where combining aggretates didn't work with pg_dump.</p>

<p>Victor Wagner sent in another revision of a patch to implement failover on the libpq connect level.</p>

<p>Aleksander Alekseev sent in another revision of a patch to optimize dynahashes.</p>

<p>Tomas Vondra sent in another revision of a patch to ensure that more predictable column statistics are being gathered and used.</p>

<p>Fabien COELHO sent in another revision of a patch to add better logging, etc. to pgbench.</p>

<p>David Rowley sent in another revision of a patch to remove functionally dependent GROUP BY columns.</p>

<p>Alexander Korotkov sent in another revision of a patch to add partial sorts.</p>

<p>Pavel St&Auml;&rsaquo;hule sent in another revision of a patch to add a parse_ident() function.</p>

<p>Artur Zakirov sent in another revision of a patch to copy regexp_t.</p>