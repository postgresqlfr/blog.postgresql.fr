---
layout: post
title: "Nouvelles hebdomadaires de PostgreSQL - 29 octobre 2017"
author: "NBougain"
redirect_from: "index.php?post/2017-11-01-nouvelles-hebdomadaires-de-postgresql-29-octobre-2017 "
---


<p>La conf&eacute;rence germanophone <em>PostgreSQL Conference 2018</em> aura lieu le 13 avril 2018 &agrave; Berlin. L'appel &agrave; conf&eacute;renciers est ouvert &agrave; l'adresse <a target="_blank" href="http://2018.pgconf.de/de/callforpapers.html">http://2018.pgconf.de/de/callforpapers.html</a> jusqu'au 9 janvier 2018, et le site de la conf&eacute;rence est disponible ici&nbsp;: <a target="_blank" href="http://2018.pgconf.de/">http://2018.pgconf.de/</a></p>

<h2>Les nouveaut&eacute;s des produits d&eacute;riv&eacute;s</h2>

<ul>

<li>Amazon Aurora avec compatibilit&eacute; PostgreSQL&nbsp;: <a target="_blank" href="https://aws.amazon.com/about-aws/whats-new/2017/10/announcing-general-availability-of-amazon-aurora-with-postgresql-compatibility/">https://aws.amazon.com/about-aws/whats-new/2017/10/announcing-general-availability-of-amazon-aurora-with-postgresql-compatibility/</a></li>

<li>Un d&eacute;p&ocirc;t RPM de PostgreSQL pour SLES 12 a &eacute;t&eacute; mis en place&nbsp;: <a target="_blank" href="https://zypp.postgresql.org/">https://zypp.postgresql.org/</a></li>

<li>pg_filedump 10.0 un utilitaire permettant de transformer les fichiers heap/index/control de PostgreSQL sous une forme humainement intelligible&nbsp;: <a target="_blank" href="https://wiki.postgresql.org/wiki/Pg_filedump">https://wiki.postgresql.org/wiki/Pg_filedump</a></li>

</ul>

<h2>Offres d'emplois autour de PostgreSQL en octobre</h2>

<ul>

<li>Internationales : <a target="_blank" href="http://archives.postgresql.org/pgsql-jobs/2017-10/">http://archives.postgresql.org/pgsql-jobs/2017-10/</a></li>

<li>Francophones : <a target="_blank" href="http://forums.postgresql.fr/viewforum.php?id=4">http://forums.postgresql.fr/viewforum.php?id=4</a></li>

</ul>

<h2>PostgreSQL Local</h2>

<ul>

<li>Le pgday.Seoul 2017 aura lieu le 4 novembre 2017 &agrave; S&eacute;oul (Cor&eacute;e du Sud). Informations en cor&eacute;en&nbsp;: <a target="_blank" href="http://pgday.postgresql.kr/">http://pgday.postgresql.kr/</a></li>

<li>La conf&eacute;rence 2ndQuadrant PostgreSQL 2017 (<em>2Q PGConf</em> en abr&eacute;g&eacute;) sera tenue les 6 et 7 novembre &agrave; New-York City, et le 9 novembre &agrave; Chicago&nbsp;: <a target="_blank" href="http://www.2qpgconf.com/">http://www.2qpgconf.com/</a></li>

<li><em>PGConf Local&nbsp;: Seattle</em> aura lieu les 13 et 14 novembre 2017&nbsp;: <a target="_blank" href="https://www.pgconf.us/#Seattle2017">https://www.pgconf.us/#Seattle2017</a></li>

<li>Le <em>PGDay Australia 2017</em> se tiendra &agrave; Melbourne le 17 novembre&nbsp;: <a target="_blank" href="http://2017.pgday.com.au/">http://2017.pgday.com.au/</a></li>

<li>Session PostgreSQL le 17 novembre 2017 &agrave; Paris&nbsp;: <a target="_blank" href="http://www.postgresql-sessions.org/en/9/start">http://www.postgresql-sessions.org/en/9/start</a></li>

<li>[ndt: MeetUp &agrave; Nantes le 28 novembre&nbsp;:<a target="_blank" href="https://www.meetup.com/fr-FR/PostgreSQL-User-Group-Nantes/">https://www.meetup.com/fr-FR/PostgreSQL-User-Group-Nantes/</a>]</li>

<li>PGDAY Brasilia 2017 aura lieu le 2 d&eacute;cembre 2017. L'appel &agrave; conf&eacute;renciers est publi&eacute; &agrave; l'adresse&nbsp;: <a target="_blank" href="http://www.pgdaybrasilia.com.br/submissao-de-palestra/">http://www.pgdaybrasilia.com.br/submissao-de-palestra/</a></li>

<li><em>PGConf Local&nbsp;: Austin</em> aura lieu les 4 & 5 d&eacute;cembre 2017. L'appel &agrave; conf&eacute;renciers a &eacute;t&eacute; lanc&eacute;&nbsp;: <a target="_blank" href="https://www.pgconf.us/conferences/Austin2017">https://www.pgconf.us/conferences/Austin2017</a></li>

<li>La PGConf.ASIA 2017 aura lieu &agrave; Akihabara (Tokyo, Japon) du 4 au 6 d&eacute;cembre 2017&nbsp;: <a target="_blank" href="http://www.pgconf.asia/EN/2017/">http://www.pgconf.asia/EN/2017/</a></li>

<li>[ndt: MeetUp &agrave; Paris le 7 d&eacute;cembre&nbsp;:<a target="_blank" href="https://www.meetup.com/fr-FR/PostgreSQL-User-Group-Paris/">https://www.meetup.com/fr-FR/PostgreSQL-User-Group-Paris/</a>]</li>

<li>FOSDEM PGDay 2018, une conf&eacute;rence d'une journ&eacute;e tenue avant l'&eacute;v&eacute;nement principal, sera tenue &agrave; Bruxelles (Belgique) le 2 f&eacute;vrier 2018&nbsp;: <a target="_blank" href="https://2018.fosdempgday.org/">https://2018.fosdempgday.org/</a></li>

<li>La <em>PGConf India 2018</em> aura lieu les 22 & 23 f&eacute;vrier 2018 &agrave; Bengalore (&Eacute;tat du Karnataka en Inde). Les propositions sont attendues via <a target="_blank" href="https://goo.gl/forms/F9hRjOIsaNasVOAz2">https://goo.gl/forms/F9hRjOIsaNasVOAz2</a> avant le 31 octobre 2017&nbsp;: <a target="_blank" href="http://pgconf.in/">http://pgconf.in/</a></li>

<li>PostgreSQL@SCaLE est un &eacute;v&eacute;nement de 2 jours &agrave; double programmes qui aura lieu les 8 & 9 mars 2017 au centre de convention de Pasadena, int&eacute;gr&eacute; au SCaLE 16X. L'appel &agrave; conf&eacute;renciers court jusqu'au 31 octobre&nbsp;: <a target="_blank" href="http://www.socallinuxexpo.org/scale/16x/cfp">http://www.socallinuxexpo.org/scale/16x/cfp</a></li>

<li>PGConf APAC 2018 se tiendra &agrave; Singapour du 22 au 24 mars 2018. L'appel &agrave; conf&eacute;renciers est lanc&eacute; jusqu'au 4 d&eacute;cembre 2017 &agrave; l'adresse <a target="_blank" href="http://2018.pgconfapac.org/cfp%C2%A0:">http://2018.pgconfapac.org/cfp&nbsp;:</a> <a target="_blank" href="http://2018.pgconfapac.org/">http://2018.pgconfapac.org/</a></li>

</ul>

<h2>PostgreSQL dans les m&eacute;dia</h2>

<ul>

<li>Planet PostgreSQL : <a target="_blank" href="http://planet.postgresql.org/">http://planet.postgresql.org/</a></li>

<li>Planet PostgreSQLFr : <a target="_blank" href="http://planete.postgresql.fr/">http://planete.postgresql.fr/</a></li>

</ul>

<p>PostgreSQL Weekly News / les nouvelles hebdomadaires vous sont offertes cette semaine par David Fetter. Traduction par l'&eacute;quipe PostgreSQLFr sous licence CC BY-NC-SA. La version originale se trouve &agrave; l'adresse suivante : <a target="_blank" href="http://www.postgresql.org/message-id/20171030002829.GA6016@fetter.org">http://www.postgresql.org/message-id/20171030002829.GA6016@fetter.org</a></p>

<p>Submit news and announcements by Sunday at 3:00pm EST5EDT. Please send English language ones to david@fetter.org, German language to pwn@pgug.de, Italian language to pwn@itpug.org.</p>

<!--more-->


<h2>Correctifs appliqu&eacute;s</h2>

<p>Tom Lane pushed:</p>

<ul>

<li>Adjust psql \d query to avoid use of @&gt; operator. It seems that the parray_gin extension has seen fit to introduce a "text[] @&gt; text[]" operator, which conflicts with the core "anyarray @&gt; anyarray" operator, causing ambiguous-operator failures if the input arguments are coercible to text[] without being exactly that type. This strikes me as a bad idea, but it's out there and people use it. As of v10, that breaks psql's query that tries to test "pg_statistic_ext.stxkind @&gt; '{d}'", since stxkind is char[]. The best workaround seems to be to avoid use of that operator. We can use a scalar-vs-array test "'d' = any(stxkind)" instead; that's arguably more readable anyway. Per report from Justin Pryzby. Backpatch to v10 where this query was added. Discussion: <a target="_blank" href="https://postgr.es/m/20171022181525.GA21884@telsasoft.com">https://postgr.es/m/20171022181525.GA21884@telsasoft.com</a> <a target="_blank" href="https://git.postgresql.org/pg/commitdiff/471d55859c11b40059aef7dd82f82b3a0dc338b1">https://git.postgresql.org/pg/commitdiff/471d55859c11b40059aef7dd82f82b3a0dc338b1</a></li>

<li>Adjust psql \d query to avoid use of @&gt; operator. It seems that the parray_gin extension has seen fit to introduce a "text[] @&gt; text[]" operator, which conflicts with the core "anyarray @&gt; anyarray" operator, causing ambiguous-operator failures if the input arguments are coercible to text[] without being exactly that type. This strikes me as a bad idea, but it's out there and people use it. As of v10, that breaks psql's query that tries to test "pg_statistic_ext.stxkind @&gt; '{d}'", since stxkind is char[]. The best workaround seems to be to avoid use of that operator. We can use a scalar-vs-array test "'d' = any(stxkind)" instead; that's arguably more readable anyway. Per report from Justin Pryzby. Backpatch to v10 where this query was added. Discussion: <a target="_blank" href="https://postgr.es/m/20171022181525.GA21884@telsasoft.com">https://postgr.es/m/20171022181525.GA21884@telsasoft.com</a> <a target="_blank" href="https://git.postgresql.org/pg/commitdiff/471d55859c11b40059aef7dd82f82b3a0dc338b1">https://git.postgresql.org/pg/commitdiff/471d55859c11b40059aef7dd82f82b3a0dc338b1</a></li>

<li>Sync our copy of the timezone library with IANA release tzcode2017c. This is a trivial update containing only cosmetic changes. The point is just to get back to being synced with an official release of tzcode, rather than some ad-hoc point in their commit history, which is where commit 47f849a3c left it. <a target="_blank" href="https://git.postgresql.org/pg/commitdiff/24a1897ab92646795bf065aa1b9d266aba74469f">https://git.postgresql.org/pg/commitdiff/24a1897ab92646795bf065aa1b9d266aba74469f</a></li>

<li>Update time zone data files to tzdata release 2017c. DST law changes in Fiji, Namibia, Northern Cyprus, Sudan, Tonga, and Turks & Caicos Islands. Historical corrections for Alaska, Apia, Burma, Calcutta, Detroit, Ireland, Namibia, and Pago Pago. <a target="_blank" href="https://git.postgresql.org/pg/commitdiff/8df4ce1eac7835d87d89a4fc4d5d3ae5554f87b7">https://git.postgresql.org/pg/commitdiff/8df4ce1eac7835d87d89a4fc4d5d3ae5554f87b7</a></li>

<li>Documentation improvements around domain types. I was a bit surprised to find that domains were almost completely unmentioned in the main SGML documentation, outside of the reference pages for CREATE/ALTER/DROP DOMAIN. In particular, noplace was it mentioned that we don't support domains over composite, making it hard to document the planned fix for that. Hence, add a section about domains to chapter 8 (Data Types). Also, modernize the type system overview in section 37.2; it had never heard of range types, and insisted on calling arrays base types, which seems a bit odd from a user's perspective; furthermore it didn't fit well with the fact that we now support arrays over types other than base types. It seems appropriate to use the term "container types" to describe all of arrays, composites, and ranges, so let's do that. Also a few other minor improvements, notably improve an example query in rowtypes.sgml by using a LATERAL function instead of an ad-hoc OFFSET 0 clause. In part this is mop-up for commit c12d570fa, which missed updating 37.2 to reflect the fact that it added arrays of domains. We could possibly back-patch this without that claim, but I don't feel a strong need to. <a target="_blank" href="https://git.postgresql.org/pg/commitdiff/a32c0923b4da7f7df95616aaecbb85ef9f12f93f">https://git.postgresql.org/pg/commitdiff/a32c0923b4da7f7df95616aaecbb85ef9f12f93f</a></li>

<li>Documentation improvements around domain types. I was a bit surprised to find that domains were almost completely unmentioned in the main SGML documentation, outside of the reference pages for CREATE/ALTER/DROP DOMAIN. In particular, noplace was it mentioned that we don't support domains over composite, making it hard to document the planned fix for that. Hence, add a section about domains to chapter 8 (Data Types). Also, modernize the type system overview in section 37.2; it had never heard of range types, and insisted on calling arrays base types, which seems a bit odd from a user's perspective; furthermore it didn't fit well with the fact that we now support arrays over types other than base types. It seems appropriate to use the term "container types" to describe all of arrays, composites, and ranges, so let's do that. Also a few other minor improvements, notably improve an example query in rowtypes.sgml by using a LATERAL function instead of an ad-hoc OFFSET 0 clause. In part this is mop-up for commit c12d570fa, which missed updating 37.2 to reflect the fact that it added arrays of domains. We could possibly back-patch this without that claim, but I don't feel a strong need to. <a target="_blank" href="https://git.postgresql.org/pg/commitdiff/a32c0923b4da7f7df95616aaecbb85ef9f12f93f">https://git.postgresql.org/pg/commitdiff/a32c0923b4da7f7df95616aaecbb85ef9f12f93f</a></li>

<li>Documentation improvements around domain types. I was a bit surprised to find that domains were almost completely unmentioned in the main SGML documentation, outside of the reference pages for CREATE/ALTER/DROP DOMAIN. In particular, noplace was it mentioned that we don't support domains over composite, making it hard to document the planned fix for that. Hence, add a section about domains to chapter 8 (Data Types). Also, modernize the type system overview in section 37.2; it had never heard of range types, and insisted on calling arrays base types, which seems a bit odd from a user's perspective; furthermore it didn't fit well with the fact that we now support arrays over types other than base types. It seems appropriate to use the term "container types" to describe all of arrays, composites, and ranges, so let's do that. Also a few other minor improvements, notably improve an example query in rowtypes.sgml by using a LATERAL function instead of an ad-hoc OFFSET 0 clause. In part this is mop-up for commit c12d570fa, which missed updating 37.2 to reflect the fact that it added arrays of domains. We could possibly back-patch this without that claim, but I don't feel a strong need to. <a target="_blank" href="https://git.postgresql.org/pg/commitdiff/a32c0923b4da7f7df95616aaecbb85ef9f12f93f">https://git.postgresql.org/pg/commitdiff/a32c0923b4da7f7df95616aaecbb85ef9f12f93f</a></li>

<li>Make setrefs.c match by ressortgroupref even for plain Vars. Previously, we skipped using search_indexed_tlist_for_sortgroupref() if the tlist expression being sought in the child plan node was merely a Var. This is purely an optimization, based on the theory that search_indexed_tlist_for_var() is faster, and one copy of a Var should be as good as another. However, the GROUPING SETS patch broke the latter assumption: grouping columns containing the "same" Var can sometimes have different outputs, as shown in the test case added here. So do it the hard way whenever a ressortgroupref marking exists. (If this seems like a bottleneck, we could imagine building a tlist index data structure for ressortgroupref values, as we do for Vars. But I'll let that idea go until there's some evidence it's worthwhile.) Back-patch to 9.6. The problem also exists in 9.5 where GROUPING SETS came in, but this patch is insufficient to resolve the problem in 9.5: there is some obscure dependency on the upper-planner-pathification work that happened in 9.6. Given that this is such a weird corner case, and no end users have complained about it, it doesn't seem worth the work to develop a fix for 9.5. Patch by me, per a report from Heikki Linnakangas. (This does not fix Heikki's original complaint, just the follow-on one.) Discussion: <a target="_blank" href="https://postgr.es/m/aefc657e-edb2-64d5-6df1-a0828f6e9104@iki.fi">https://postgr.es/m/aefc657e-edb2-64d5-6df1-a0828f6e9104@iki.fi</a> <a target="_blank" href="https://git.postgresql.org/pg/commitdiff/08f1e1f0a47b4b0e87b07b9794698747b279c711">https://git.postgresql.org/pg/commitdiff/08f1e1f0a47b4b0e87b07b9794698747b279c711</a></li>

<li>Support domains over composite types. This is the last major omission in our domains feature: you can now make a domain over anything that's not a pseudotype. The major complication from an implementation standpoint is that places that might be creating tuples of a domain type now need to be prepared to apply domain_check(). It seems better that unprepared code fail with an error like "&lt;type&gt; is not composite" than that it silently fail to apply domain constraints. Therefore, relevant infrastructure like get_func_result_type() and lookup_rowtype_tupdesc() has been adjusted to treat domain-over-composite as a distinct case that unprepared code won't recognize, rather than just transparently treating it the same as plain composite. This isn't a 100% solution to the possibility of overlooked domain checks, but it catches most places. In passing, improve typcache.c's support for domains (it can now cache the identity of a domain's base type), and rewrite the argument handling logic in jsonfuncs.c's populate_record[set]_worker to reduce duplicative per-call lookups. I believe this is code-complete so far as the core and contrib code go. The PLs need varying amounts of work, which will be tackled in followup patches. Discussion: <a target="_blank" href="https://postgr.es/m/4206.1499798337@sss.pgh.pa.us">https://postgr.es/m/4206.1499798337@sss.pgh.pa.us</a> <a target="_blank" href="https://git.postgresql.org/pg/commitdiff/37a795a60b4f4b1def11c615525ec5e0e9449e05">https://git.postgresql.org/pg/commitdiff/37a795a60b4f4b1def11c615525ec5e0e9449e05</a></li>

<li>Support domains over composite types in PL/Tcl. Since PL/Tcl does little with SQL types internally, this is just a matter of making it work with composite-domain function arguments and results. In passing, make it allow RECORD-type arguments --- that's a trivial change that nobody had bothered with up to now. Discussion: <a target="_blank" href="https://postgr.es/m/4206.1499798337@sss.pgh.pa.us">https://postgr.es/m/4206.1499798337@sss.pgh.pa.us</a> <a target="_blank" href="https://git.postgresql.org/pg/commitdiff/820c0305f64507490f00b6220f9175a303c821dd">https://git.postgresql.org/pg/commitdiff/820c0305f64507490f00b6220f9175a303c821dd</a></li>

<li>Doc: mention that you can't PREPARE TRANSACTION after NOTIFY. The NOTIFY page said this already, but the PREPARE TRANSACTION page missed it. Discussion: <a target="_blank" href="https://postgr.es/m/20171024010602.1488.80066@wrigleys.postgresql.org">https://postgr.es/m/20171024010602.1488.80066@wrigleys.postgresql.org</a> <a target="_blank" href="https://git.postgresql.org/pg/commitdiff/e4fbf22831c2bbcf032ee60a327b871d2364b3f5">https://git.postgresql.org/pg/commitdiff/e4fbf22831c2bbcf032ee60a327b871d2364b3f5</a></li>

<li>Rethink the dependencies recorded for FieldSelect/FieldStore nodes. On closer investigation, commits f3ea3e3e8 et al were a few bricks shy of a load. What we need is not so much to lock down the result type of a FieldSelect, as to lock down the existence of the column it's trying to extract. Otherwise, we can break it by dropping that column. The dependency on the result type is then held indirectly through the column, and doesn't need to be recorded explicitly. Out of paranoia, I left in the code to record a dependency on the result type, but it's used only if we can't identify the pg_class OID for the column. That shouldn't ever happen right now, AFAICS, but it seems possible that in future the input node could be marked as being of type RECORD rather than some specific composite type. Likewise for FieldStore. Like the previous patch, back-patch to all supported branches. Discussion: <a target="_blank" href="https://postgr.es/m/22571.1509064146@sss.pgh.pa.us">https://postgr.es/m/22571.1509064146@sss.pgh.pa.us</a> <a target="_blank" href="https://git.postgresql.org/pg/commitdiff/6784d7a1dc69d53b7f41eebf62bf7ffd63885294">https://git.postgresql.org/pg/commitdiff/6784d7a1dc69d53b7f41eebf62bf7ffd63885294</a></li>

<li>Fix crash when columns have been added to the end of a view. expandRTE() supposed that an RTE_SUBQUERY subquery must have exactly as many non-junk tlist items as the RTE has column aliases for it. This was true at the time the code was written, and is still true so far as parse analysis is concerned --- but when the function is used during planning, the subquery might have appeared through insertion of a view that now has more columns than it did when the outer query was parsed. This results in a core dump if, for instance, we have to expand a whole-row Var that references the subquery. To avoid crashing, we can either stop expanding the RTE when we run out of aliases, or invent new aliases for the added columns. While the latter might be more useful, the former is consistent with what expandRTE() does for composite-returning functions in the RTE_FUNCTION case, so it seems like we'd better do it that way. Per bug #14876 from Samuel Horwitz. This has been busted since commit ff1ea2173 allowed views to acquire more columns, so back-patch to all supported branches. Discussion: <a target="_blank" href="https://postgr.es/m/20171026184035.1471.82810@wrigleys.postgresql.org">https://postgr.es/m/20171026184035.1471.82810@wrigleys.postgresql.org</a> <a target="_blank" href="https://git.postgresql.org/pg/commitdiff/d5b760ecb5e172252810fae877e6d6193b818167">https://git.postgresql.org/pg/commitdiff/d5b760ecb5e172252810fae877e6d6193b818167</a></li>

<li>Dept of second thoughts: keep aliasp_item in sync with tlistitem. Commit d5b760ecb wasn't quite right, on second thought: if the caller didn't ask for column names then it would happily emit more Vars than if the caller did ask for column names. This is surely not a good idea. Advance the aliasp_item whether or not we're preparing a colnames list. <a target="_blank" href="https://git.postgresql.org/pg/commitdiff/d76886c2d33123299ce7c8255a71e39b9e53711b">https://git.postgresql.org/pg/commitdiff/d76886c2d33123299ce7c8255a71e39b9e53711b</a></li>

<li>Support domains over composite types in PL/Perl. In passing, don't insist on rsi-&gt;expectedDesc being set unless we actually need it; this allows succeeding in a couple of cases where PL/Perl functions returning setof composite would have failed before, and makes the error message more apropos in other cases. Discussion: <a target="_blank" href="https://postgr.es/m/4206.1499798337@sss.pgh.pa.us">https://postgr.es/m/4206.1499798337@sss.pgh.pa.us</a> <a target="_blank" href="https://git.postgresql.org/pg/commitdiff/60651e4cddbb77e8f1a0c7fc0be6a7e7bf626fe0">https://git.postgresql.org/pg/commitdiff/60651e4cddbb77e8f1a0c7fc0be6a7e7bf626fe0</a></li>

</ul>

<p>Andrew Dunstan pushed:</p>

<ul>

<li>Add a utility function to extract variadic function arguments. This is epecially useful in the case or "VARIADIC ANY" functions. The caller can get the artguments and types regardless of whether or not and explicit VARIADIC array argument has been used. The function also provides an option to convert arguments on type "unknown" to to "text". Michael Paquier and me, reviewed by Tom Lane. Backpatch to 9.4 in order to support the following json bug fix. <a target="_blank" href="https://git.postgresql.org/pg/commitdiff/f3c6e8a27a8f8436cada9a42e4f57338ed38c785">https://git.postgresql.org/pg/commitdiff/f3c6e8a27a8f8436cada9a42e4f57338ed38c785</a></li>

<li>Process variadic arguments consistently in json functions. json_build_object and json_build_array and the jsonb equivalents did not correctly process explicit VARIADIC arguments. They are modified to use the new extract_variadic_args() utility function which abstracts away the details of the call method. Michael Paquier, reviewed by Tom Lane and Dmitry Dolgov. Backpatch to 9.5 for the jsonb fixes and 9.4 for the json fixes, as that's where they originated. <a target="_blank" href="https://git.postgresql.org/pg/commitdiff/18fc4ecf4afafe40bd7e7577bd611e5caf74c9fd">https://git.postgresql.org/pg/commitdiff/18fc4ecf4afafe40bd7e7577bd611e5caf74c9fd</a></li>

<li>Undo inadvertent change in capitalization in commit 18fc4ec. <a target="_blank" href="https://git.postgresql.org/pg/commitdiff/adee9e4e317169463816d005e8bf901333271917">https://git.postgresql.org/pg/commitdiff/adee9e4e317169463816d005e8bf901333271917</a></li>

<li>Improve gendef.pl diagnostic on failure to open sym file. There have been numerous buildfarm failures but the diagnostic is currently silent about the reason for failure to open the file. Let's see if we can get to the bottom of it. Backpatch to all live branches. <a target="_blank" href="https://git.postgresql.org/pg/commitdiff/74d2c0dbfd94aa5512be3828a793b4c2d43df2d0">https://git.postgresql.org/pg/commitdiff/74d2c0dbfd94aa5512be3828a793b4c2d43df2d0</a></li>

</ul>

<p>Michael Meskes pushed:</p>

<ul>

<li>Fixed handling of escape character in libecpg. Patch by Tsunakawa Takayuki &lt;tsunakawa.takay@jp.fujitsu.com&gt; <a target="_blank" href="https://git.postgresql.org/pg/commitdiff/0af98a95cf8397d36202a34cd615f222faf24e9a">https://git.postgresql.org/pg/commitdiff/0af98a95cf8397d36202a34cd615f222faf24e9a</a></li>

</ul>

<p>Robert Haas pushed:</p>

<ul>

<li>In relevant log messages, indicate whether vacuums are aggressive. Kyotaro Horiguchi, reviewed Masahiko Sawada, David G. Johnston, &Aacute;lvaro Herrera, and me. Grammar correction to the final posted patch by me. Discussion: <a target="_blank" href="http://postgr.es/m/20170329.124649.193656100.horiguchi.kyotaro@lab.ntt.co.jp">http://postgr.es/m/20170329.124649.193656100.horiguchi.kyotaro@lab.ntt.co.jp</a> <a target="_blank" href="https://git.postgresql.org/pg/commitdiff/b55509332f50f998b6e8b3830a51c5b9d8f666aa">https://git.postgresql.org/pg/commitdiff/b55509332f50f998b6e8b3830a51c5b9d8f666aa</a></li>

<li>Fix mistaken failure to allow parallelism in corner case. If we try to run a parallel plan in serial mode because, for example, it's going to be scanned via a cursor, but for some reason we're already in parallel mode (for example because an outer query is running in parallel), we'd incorrectly try to launch workers. Fix by adding a flag to the EState, so that we can be certain that ExecutePlan() and ExecGather()/ExecGatherMerge() will have the same idea about whether we are executing serially or in parallel. Report and fix by Amit Kapila with help from Kuntal Ghosh. A few tweaks by me. Discussion: <a target="_blank" href="http://postgr.es/m/CAA4eK1+_BuZrmVCeua5Eqnm4Co9DAXdM5HPAOE2J19ePbR912Q@mail.gmail.com">http://postgr.es/m/CAA4eK1+_BuZrmVCeua5Eqnm4Co9DAXdM5HPAOE2J19ePbR912Q@mail.gmail.com</a> <a target="_blank" href="https://git.postgresql.org/pg/commitdiff/639c1a6bb9ee08fe4757a6fab1ddbd01291515e1">https://git.postgresql.org/pg/commitdiff/639c1a6bb9ee08fe4757a6fab1ddbd01291515e1</a></li>

<li>Move new structure member to the end. Reduces ABI breakage. Per Tom Lane. Discussion: <a target="_blank" href="http://postgr.es/m/4035.1509113974@sss.pgh.pa.us">http://postgr.es/m/4035.1509113974@sss.pgh.pa.us</a> <a target="_blank" href="https://git.postgresql.org/pg/commitdiff/94d622f27be6d48e61a68496da4f2efb06fe8746">https://git.postgresql.org/pg/commitdiff/94d622f27be6d48e61a68496da4f2efb06fe8746</a></li>

<li>Revert "Move new structure member to the end.". This reverts commit 94d622f27be6d48e61a68496da4f2efb06fe8746. That commit was supposed to get pushed to REL_10_STABLE, but I messed up. <a target="_blank" href="https://git.postgresql.org/pg/commitdiff/f0392e677ed098e9e514ad5e4d5dc148c0474c63">https://git.postgresql.org/pg/commitdiff/f0392e677ed098e9e514ad5e4d5dc148c0474c63</a></li>

<li>Allow parallel query for prepared statements with generic plans. This was always intended to work, but due to an oversight in max_parallel_hazard_walker, it didn't. In testing, we missed the fact that it was only working for custom plans, where the parameter value has been substituted for the parameter itself early enough that everything worked. In a generic plan, the Param node survives and must be treated as parallel-safe. SerializeParamList provides for the transmission of parameter values to workers. Amit Kapila with help from Kuntal Ghosh. Some changes by me. Discussion: <a target="_blank" href="http://postgr.es/m/CAA4eK1+_BuZrmVCeua5Eqnm4Co9DAXdM5HPAOE2J19ePbR912Q@mail.gmail.com">http://postgr.es/m/CAA4eK1+_BuZrmVCeua5Eqnm4Co9DAXdM5HPAOE2J19ePbR912Q@mail.gmail.com</a> <a target="_blank" href="https://git.postgresql.org/pg/commitdiff/682ce911f8f30de39b13cf211fc8ceb8c6cbc01b">https://git.postgresql.org/pg/commitdiff/682ce911f8f30de39b13cf211fc8ceb8c6cbc01b</a></li>

<li>Fix misplaced ReleaseSysCache call in get_default_partition_oid. Julien Rouhaud Discussion: <a target="_blank" href="http://postgr.es/m/CAOBaU_Y4omLA+VbsVdA-JwBLoJWiPxfdKCkMjrZM7NMZxa1fKw@mail.gmail.com">http://postgr.es/m/CAOBaU_Y4omLA+VbsVdA-JwBLoJWiPxfdKCkMjrZM7NMZxa1fKw@mail.gmail.com</a> <a target="_blank" href="https://git.postgresql.org/pg/commitdiff/1310ac258c773ab9d41650b509098dd01cb4ecf3">https://git.postgresql.org/pg/commitdiff/1310ac258c773ab9d41650b509098dd01cb4ecf3</a></li>

<li>Fix grammar. Etsuro Fujita Discussion: <a target="_blank" href="http://postgr.es/m/cc7767b6-6a1b-74a2-8b3c-48b8e64c12ed@lab.ntt.co.jp">http://postgr.es/m/cc7767b6-6a1b-74a2-8b3c-48b8e64c12ed@lab.ntt.co.jp</a> <a target="_blank" href="https://git.postgresql.org/pg/commitdiff/24fd674a1affe1ca9776bd6b21b2b35feb0fe6ed">https://git.postgresql.org/pg/commitdiff/24fd674a1affe1ca9776bd6b21b2b35feb0fe6ed</a></li>

<li>Add table_constraint synopsis to ALTER TABLE documentation. This is already present in the CREATE TABLE documentation, but it's nicer not to have to refer to CREATE TABLE to find out the syntax for ALTER TABLE. L&aelig;titia Avrot <a target="_blank" href="https://git.postgresql.org/pg/commitdiff/9f295c08f8776213ccb592de0c4f094738d6d841">https://git.postgresql.org/pg/commitdiff/9f295c08f8776213ccb592de0c4f094738d6d841</a></li>

<li>Improve comments for parallel executor estimation functions. The previous comment (which was copied as boilerplate from one file to the next) implied that it was the executor node itself which was being serialized, but that's not right. We're not serializing the executor nodes; we're just allowing them to store some additional information in DSM. Adjusts the comment to reflect this. Discussion: <a target="_blank" href="http://postgr.es/m/CA+TgmoaHVinxG=3h6qBAsyV8xaDyQwbzK7YZnYfE8nJFMK1=FA@mail.gmail.com">http://postgr.es/m/CA+TgmoaHVinxG=3h6qBAsyV8xaDyQwbzK7YZnYfE8nJFMK1=FA@mail.gmail.com</a> <a target="_blank" href="https://git.postgresql.org/pg/commitdiff/11c1d555cebe8045a45bc0ee10d0673fad8d4895">https://git.postgresql.org/pg/commitdiff/11c1d555cebe8045a45bc0ee10d0673fad8d4895</a></li>

<li>Fix typo. Eiji Seki Discussion: <a target="_blank" href="http://postgr.es/m/A11BD0E1A40FAC479D740CEFA373E203397E5276@g01jpexmbkw05">http://postgr.es/m/A11BD0E1A40FAC479D740CEFA373E203397E5276@g01jpexmbkw05</a> <a target="_blank" href="https://git.postgresql.org/pg/commitdiff/c6fd5cd7062283575a436ec4ea3ed7899ace79a0">https://git.postgresql.org/pg/commitdiff/c6fd5cd7062283575a436ec4ea3ed7899ace79a0</a></li>

<li>Add hash_combine64. Extracted from a larger patch by Amul Sul, with some comment additions by me. Discussion: <a target="_blank" href="http://postgr.es/m/20171024113004.hn5qajypin4dy5sw@alap3.anarazel.de">http://postgr.es/m/20171024113004.hn5qajypin4dy5sw@alap3.anarazel.de</a> <a target="_blank" href="https://git.postgresql.org/pg/commitdiff/b7f3eb31405f1dbbf086e5a8f88569a6dc85157a">https://git.postgresql.org/pg/commitdiff/b7f3eb31405f1dbbf086e5a8f88569a6dc85157a</a></li>

<li>pg_receivewal: Add --no-sync option. Michael Paquier, reviewed by Kuntal Ghosh and by me. I did a little wordsmithing on the documentation, too. Discussion: <a target="_blank" href="http://postgr.es/m/CAB7nPqTuXuyEoVKcWcExh_b0uAjgWd_14KfGLrCTccBZ=VA0KA@mail.gmail.com">http://postgr.es/m/CAB7nPqTuXuyEoVKcWcExh_b0uAjgWd_14KfGLrCTccBZ=VA0KA@mail.gmail.com</a> <a target="_blank" href="https://git.postgresql.org/pg/commitdiff/5f3971291fc231bb65a38198b1bcb1c29ef63108">https://git.postgresql.org/pg/commitdiff/5f3971291fc231bb65a38198b1bcb1c29ef63108</a></li>

<li>Fix problems with the "role" GUC and parallel query. Without this fix, dropping a role can sometimes result in parallel query failures in sessions that have used "SET ROLE" to assume the dropped role, even if that setting isn't active any more. Report by Pavan Deolasee. Patch by Amit Kapila, reviewed by me. Discussion: <a target="_blank" href="http://postgr.es/m/CABOikdOomRcZsLsLK+Z+qENM1zxyaWnAvFh3MJZzZnnKiF+REg@mail.gmail.com">http://postgr.es/m/CABOikdOomRcZsLsLK+Z+qENM1zxyaWnAvFh3MJZzZnnKiF+REg@mail.gmail.com</a> <a target="_blank" href="https://git.postgresql.org/pg/commitdiff/846fcc85167c417873865099d70068ed85f758a8">https://git.postgresql.org/pg/commitdiff/846fcc85167c417873865099d70068ed85f758a8</a></li>

</ul>

<h2>Correctifs en attente</h2>

<p>Tom Lane sent in a patch to fix an asymmetry in parse_func.c.</p>

<p>Amit Langote and Tom Lane traded patches to fix an infelicity in joinaliasvars uncovered by sqlsmith.</p>

<p>&Aacute;lvaro Herrera sent in two revisions of a patch to fix autovacuum work items.</p>

<p>Amit Khandekar sent in two more revisions of a patch to implement UPDATE of partition keys in declaratively partitioned tables so that tuples move to the appropriate partition as needed.</p>

<p>Doug Rady sent in another revision of a patch to pgbench which adds an option to build using ppoll() for larger connection counts.</p>

<p>Ivan Kartyshov sent in three more revisions of a patch to make async subscribers to wait for lsn to be replayed.</p>

<p>Amit Langote sent in five more revisions of a patch to prune partitions faster.</p>

<p>&Aacute;lvaro Herrera sent in two more revisions of a patch to enable indexes on partitions to be unique.</p>

<p>Thomas Munro sent in two more revisions of a patch to implement parallel hash.</p>

<p>Anthony Bykov sent in a patch to add a JSONB TRANSFORM for PL/Perl.</p>

<p>Simon Riggs sent in a patch to remove the code that maintained two checkpoint's WAL files and all associated stuff.</p>

<p>Masahiko Sawada sent in another revision of a patch to allow atomic commits on foreign servers.</p>

<p>Amul Sul sent in two more revisions of a patch to add hash partitioning.</p>

<p>Anthony Bykov sent in a patch to create a JSONB TRANSFORM for PL/Python2U.</p>

<p>Tomas Vondra sent in two revisions of a patch to implement BRIN multi-range indexes.</p>

<p>Micha&euml;l Paquier sent in three revisions of a patch to implement pg_receivewal --no-sync.</p>

<p>Jing Wang sent in a patch to support unicode host variables in ECPG.</p>

<p>Gao Zengqi (&#39640;&#22686;&#29734;) sent in a patch to fix an endless loop in ECPG in informix mode.</p>

<p>Petr Jel&iacute;nek sent in a patch to prevent resetting additional columns on the logical subscriber to NULL after UPDATE. When the subscriber's table had extra columns, this was happening, and was usually the wrong thing.</p>

<p>Rushabh Lathia sent in another revision of a patch to add parallel B-tree index build sorting.</p>

<p>Masahiko Sawada sent in another revision of a patch to move relation extension locks out of the heavyweight lock manager.</p>

<p>Micha&euml;l Paquier sent in a patch to place the timeline ID in the backup_label file.</p>

<p>Kyotaro HORIGUCHI sent in another revision of a patch to enable switching WAL source in the midst of a record.</p>

<p>Etsuro Fujita sent in two more revisions of a patch to add support for tuple routing to foreign partitions.</p>

<p>Peter Eisentraut sent in a patch to convert ids to upper case at build time.</p>

<p>Yura Sokolov sent in two more revisions of a patch to implement logical decoding of two-phase transactions.</p>

<p>L&aelig;titia Avrot sent in a patch to add a table_constraint description to the ALTER TABLE synopsis.</p>

<p>Andrey Borodin sent in two revisions of a patch to add index-only scan for cube and seg.</p>

<p>Peter Eisentraut sent in another revision of a patch to replace hand-tooled boolean handling with stdbool.h.</p>

<p>Robert Haas sent in another revision of a patch to enable libpq protocol negotiation.</p>

<p>Jeevan Chalke sent in another revision of a patch to implement partition-wise aggregation/grouping.</p>

<p>Takayuki Tsunakawa sent in two revisions of a patch to fix a startup crash on Windows.</p>

<p>Julien Rouhaud sent in a patch to fix unsafe tuple releasing in get_default_partition_oid.</p>

<p>Pavel St&#283;hule sent in a patch to enable psql to take sorting arguments for some of its \ commands.</p>

<p>Chris Travers sent in a patch to restrict pg_rewind to data/wal directories.</p>

<p>Amit Kapila sent in another revision of a patch to make extern params parallel safe.</p>

<p>Amit Kapila sent in another revision of a patch to fix role handling in parallel workers.</p>

<p>Nikolay Shaplov sent in a patch to better document some regression tests for reloptions.</p>

<p>Dmitry Dolgov sent in another revision of a patch to implement generic type subscripting.</p>